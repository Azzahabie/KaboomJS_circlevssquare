(()=>{"use strict";var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,a=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&o(e,r,t[r]);if(n)for(var r of n(t))i.call(t,r)&&o(e,r,t[r]);return e},l=(e,n)=>t(e,r(n)),u=(t,r)=>e(t,"name",{value:r,configurable:!0}),h=(e,t)=>()=>(e&&(t=e(e=0)),t);function c(e){return e*Math.PI/180}function d(e){return 180*e/Math.PI}function f(e,t,r){return t>r?f(e,r,t):Math.min(Math.max(e,t),r)}function m(e,t,r){return e+(t-e)*r}function p(e,t,r,n,s){return n+(e-t)/(r-t)*(s-n)}function g(e,t,r,n,s){return f(p(e,t,r,n,s),n,s)}function y(...e){if(0===e.length)return y(0,0);if(1===e.length){if("number"==typeof e[0])return y(e[0],e[0]);if(x(e[0]))return y(e[0].x,e[0].y);if(Array.isArray(e[0])&&2===e[0].length)return y.apply(null,e[0])}return{x:e[0],y:e[1],clone(){return y(this.x,this.y)},add(...e){let t=y(...e);return y(this.x+t.x,this.y+t.y)},sub(...e){let t=y(...e);return y(this.x-t.x,this.y-t.y)},scale(e){return y(this.x*e,this.y*e)},dist(...e){let t=y(...e);return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},len(){return this.dist(y(0,0))},unit(){return this.scale(1/this.len())},normal(){return y(this.y,-this.x)},dot(...e){let t=y(...e);return y(this.x*t.x,this.y*t.y)},angle(...e){let t=y(...e);return Math.atan2(this.y-t.y,this.x-t.x)},lerp(e,t){return y(m(this.x,e.x,t),m(this.y,e.y,t))},eq(e){return this.x===e.x&&this.y===e.y},str(){return`(${this.x}, ${this.y})`}}}function v(e){return y(Math.cos(e),Math.sin(e))}function w(e,t,r){return{x:e,y:t,z:r,xy(){return y(this.x,this.y)}}}function x(e){return void 0!==e&&void 0!==e.x&&void 0!==e.y}function b(e){return void 0!==e&&void 0!==e.x&&void 0!==e.y&&void 0!==e.z}function k(e){return void 0!==e&&void 0!==e.r&&void 0!==e.g&&void 0!==e.b&&void 0!==e.a}function S(e){if(void 0!==e&&Array.isArray(e.m)&&16===e.m.length)return e}function A(...e){if(0===e.length)return R();if(1===e.length){if(k(e[0]))return R(e[0]);if(Array.isArray(e[0])&&3===e[0].length)return A.apply(null,e[0])}return R(e[0],e[1],e[2],1)}function R(...e){var t;if(0===e.length)return R(1,1,1,1);if(1===e.length){if(k(e[0]))return R(e[0].r,e[0].g,e[0].b,e[0].a);if(Array.isArray(e[0])&&4===e[0].length)return R.apply(null,e[0])}return{r:e[0],g:e[1],b:e[2],a:null!=(t=e[3])?t:1,clone(){return R(this.r,this.g,this.b,this.a)},lighten(e){return R(this.r+e,this.g+e,this.b+e,this.a)},darken(e){return this.lighten(-e)},invert(){return R(1-this.r,1-this.g,1-this.b,this.a)},isDark(e=.5){return this.r+this.g+this.b<3*e},isLight(e=.5){return this.r+this.g+this.b>3*e},eq(e){return this.r===e.r&&this.g===e.g&&this.b===e.g&&this.a===e.a}}}function P(e,t,r,n){return{x:e,y:t,w:r,h:n,clone(){return P(this.x,this.y,this.w,this.h)},eq(e){return this.x===e.x&&this.y===e.y&&this.w===e.w&&this.h===e.h}}}function E(e){return{m:e?[...e]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],clone(){return E(this.m)},mult(e){let t=[];for(let r=0;r<4;r++)for(let n=0;n<4;n++)t[4*r+n]=this.m[0+n]*e.m[4*r+0]+this.m[4+n]*e.m[4*r+1]+this.m[8+n]*e.m[4*r+2]+this.m[12+n]*e.m[4*r+3];return E(t)},multVec4(e){return{x:e.x*this.m[0]+e.y*this.m[4]+e.z*this.m[8]+e.w*this.m[12],y:e.x*this.m[1]+e.y*this.m[5]+e.z*this.m[9]+e.w*this.m[13],z:e.x*this.m[2]+e.y*this.m[6]+e.z*this.m[10]+e.w*this.m[14],w:e.x*this.m[3]+e.y*this.m[7]+e.z*this.m[11]+e.w*this.m[15]}},multVec3(e){let t=this.multVec4({x:e.x,y:e.y,z:e.z,w:1});return w(t.x,t.y,t.z)},multVec2(e){return y(e.x*this.m[0]+e.y*this.m[4]+0*this.m[8]+1*this.m[12],e.x*this.m[1]+e.y*this.m[5]+0*this.m[9]+1*this.m[13])},translate(e){return this.mult(E([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,0,1]))},scale(e){return this.mult(E([e.x,0,0,0,0,e.y,0,0,0,0,1,0,0,0,0,1]))},rotateX(e){return this.mult(E([1,0,0,0,0,Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1]))},rotateY(e){return this.mult(E([Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1]))},rotateZ(e){return this.mult(E([Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1,0,0,0,0,1]))},invert(){let e=[],t=this.m[10]*this.m[15]-this.m[14]*this.m[11],r=this.m[9]*this.m[15]-this.m[13]*this.m[11],n=this.m[9]*this.m[14]-this.m[13]*this.m[10],s=this.m[8]*this.m[15]-this.m[12]*this.m[11],i=this.m[8]*this.m[14]-this.m[12]*this.m[10],o=this.m[8]*this.m[13]-this.m[12]*this.m[9],a=this.m[6]*this.m[15]-this.m[14]*this.m[7],l=this.m[5]*this.m[15]-this.m[13]*this.m[7],u=this.m[5]*this.m[14]-this.m[13]*this.m[6],h=this.m[4]*this.m[15]-this.m[12]*this.m[7],c=this.m[4]*this.m[14]-this.m[12]*this.m[6],d=this.m[5]*this.m[15]-this.m[13]*this.m[7],f=this.m[4]*this.m[13]-this.m[12]*this.m[5],m=this.m[6]*this.m[11]-this.m[10]*this.m[7],p=this.m[5]*this.m[11]-this.m[9]*this.m[7],g=this.m[5]*this.m[10]-this.m[9]*this.m[6],y=this.m[4]*this.m[11]-this.m[8]*this.m[7],v=this.m[4]*this.m[10]-this.m[8]*this.m[6],w=this.m[4]*this.m[9]-this.m[8]*this.m[5];e[0]=this.m[5]*t-this.m[6]*r+this.m[7]*n,e[4]=-(this.m[4]*t-this.m[6]*s+this.m[7]*i),e[8]=this.m[4]*r-this.m[5]*s+this.m[7]*o,e[12]=-(this.m[4]*n-this.m[5]*i+this.m[6]*o),e[1]=-(this.m[1]*t-this.m[2]*r+this.m[3]*n),e[5]=this.m[0]*t-this.m[2]*s+this.m[3]*i,e[9]=-(this.m[0]*r-this.m[1]*s+this.m[3]*o),e[13]=this.m[0]*n-this.m[1]*i+this.m[2]*o,e[2]=this.m[1]*a-this.m[2]*l+this.m[3]*u,e[6]=-(this.m[0]*a-this.m[2]*h+this.m[3]*c),e[10]=this.m[0]*d-this.m[1]*h+this.m[3]*f,e[14]=-(this.m[0]*u-this.m[1]*c+this.m[2]*f),e[3]=-(this.m[1]*m-this.m[2]*p+this.m[3]*g),e[7]=this.m[0]*m-this.m[2]*y+this.m[3]*v,e[11]=-(this.m[0]*p-this.m[1]*y+this.m[3]*w),e[15]=this.m[0]*g-this.m[1]*v+this.m[2]*w;let x=this.m[0]*e[0]+this.m[1]*e[4]+this.m[2]*e[8]+this.m[3]*e[12];for(let t=0;t<4;t++)for(let r=0;r<4;r++)e[4*t+r]*=1/x;return E(e)}}}function T(e,t,r){return e+(Math.sin(r)+1)/2*(t-e)}function _(e){return{seed:e,gen(...e){if(0===e.length)return this.seed=(B*this.seed+O)%N,this.seed/N;if(1===e.length){if("number"==typeof e[0])return this.gen(0,e[0]);if(x(e[0]))return this.gen(y(0,0),e[0]);if(k(e[0]))return this.gen(R(0,0,0,0),e[0])}else if(2===e.length){if("number"==typeof e[0]&&"number"==typeof e[1])return this.gen()*(e[1]-e[0])+e[0];if(x(e[0])&&x(e[1]))return y(this.gen(e[0].x,e[1].x),this.gen(e[0].y,e[1].y));if(k(e[0])&&k(e[1]))return R(this.gen(e[0].r,e[1].r),this.gen(e[0].g,e[1].g),this.gen(e[0].b,e[1].b),this.gen(e[0].a,e[1].a))}}}}function D(e){Y.seed=e}function M(...e){return Y.gen(...e)}function F(e){return M()<=e}function I(e){return e[Math.floor(M(e.length))]}function L(e,t){return e.p2.x>=t.p1.x&&e.p1.x<=t.p2.x&&e.p2.y>=t.p1.y&&e.p1.y<=t.p2.y}function C(e,t){return e.p2.x>t.p1.x&&e.p1.x<t.p2.x&&e.p2.y>t.p1.y&&e.p1.y<t.p2.y}function q(e,t){return t.x>=e.p1.x&&t.x<=e.p2.x&&t.y>=e.p1.y&&t.y<e.p2.y}var B,O,N,Y,j=h((()=>{u(c,"deg2rad"),u(d,"rad2deg"),u(f,"clamp"),u(m,"lerp"),u(p,"map"),u(g,"mapc"),u(y,"vec2"),u(v,"vec2FromAngle"),u(w,"vec3"),u(x,"isVec2"),u(b,"isVec3"),u(k,"isColor"),u(S,"isMat4"),u(A,"rgb"),u(R,"rgba"),u(P,"quad"),u(E,"mat4"),u(T,"wave"),B=1103515245,O=12345,N=2147483648,Y=_(Date.now()),u(_,"makeRng"),u(D,"randSeed"),u(M,"rand"),u(F,"chance"),u(I,"choose"),u(L,"colRectRect"),u(C,"overlapRectRect"),u(q,"colRectPt")}));function U(e,t){let r=typeof e,n=typeof t;if(r!==n)return!1;if("object"===r&&"object"===n){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let n of r){let r=e[n],s=t[n];if(("function"!=typeof r||"function"!=typeof s)&&!U(r,s))return!1}return!0}return e===t}var H=h((()=>{u(U,"deepEq")}));function z(e){switch(e){case"topleft":return y(-1,-1);case"top":return y(0,-1);case"topright":return y(1,-1);case"left":return y(-1,0);case"center":return y(0,0);case"right":return y(1,0);case"botleft":return y(-1,1);case"bot":return y(0,1);case"botright":return y(1,1);default:return e}}function X(e,t){let r=(()=>{switch(t.texFilter){case"linear":return e.LINEAR;case"nearest":default:return e.NEAREST}})(),n=(()=>{var r;let n=o($,Z),s=i(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),a=null!=(r=t.clearColor)?r:R(0,0,0,1);e.clearColor(a.r,a.g,a.b,a.a),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);let l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,4*G,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);let u=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.bufferData(e.ELEMENT_ARRAY_BUFFER,2*G,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);let h=i(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2));return{drawCalls:0,lastDrawCalls:0,defProg:n,curProg:n,defTex:s,curTex:s,curUniform:{},vbuf:l,ibuf:u,vqueue:[],iqueue:[],transform:E(),transformStack:[],clearColor:a,bgTex:h}})();function s(e){return Math.log(e)/Math.log(2)%1==0}function i(t){let n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r);let i=s(t.width)&&s(t.height)?e.REPEAT:e.CLAMP_TO_EDGE;return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i),e.bindTexture(e.TEXTURE_2D,null),{width:t.width,height:t.height,bind(){e.bindTexture(e.TEXTURE_2D,n)},unbind(){e.bindTexture(e.TEXTURE_2D,null)}}}function o(t=$,r=Z){let n,s=K.replace("{{user}}",null!=t?t:$),i=Q.replace("{{user}}",null!=r?r:Z),o=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(o,s),e.shaderSource(a,i),e.compileShader(o),e.compileShader(a),n=e.getShaderInfoLog(o))throw new Error(n);if(n=e.getShaderInfoLog(a))throw new Error(n);let l=e.createProgram();if(e.attachShader(l,o),e.attachShader(l,a),e.bindAttribLocation(l,0,"a_pos"),e.bindAttribLocation(l,1,"a_uv"),e.bindAttribLocation(l,2,"a_color"),e.linkProgram(l),(n=e.getProgramInfoLog(l))&&"\n"!==n)throw new Error(n);return{bind(){e.useProgram(l)},unbind(){e.useProgram(null)},bindAttribs(){e.vertexAttribPointer(0,3,e.FLOAT,!1,4*W,0),e.enableVertexAttribArray(0),e.vertexAttribPointer(1,2,e.FLOAT,!1,4*W,12),e.enableVertexAttribArray(1),e.vertexAttribPointer(2,4,e.FLOAT,!1,4*W,20),e.enableVertexAttribArray(2)},send(t){this.bind();for(let r in t){let n=t[r],s=e.getUniformLocation(l,r);"number"==typeof n?e.uniform1f(s,n):S(n)?e.uniformMatrix4fv(s,!1,new Float32Array(n.m)):k(n)?e.uniform4f(s,n.r,n.g,n.b,n.a):b(n)?e.uniform3f(s,n.x,n.y,n.z):x(n)&&e.uniform2f(s,n.x,n.y)}this.unbind()}}}function h(e,t,r,n){let s=e.width/t,i=1/s,o=1/(e.height/r),a={},l=n.split("").entries();for(let[e,t]of l)a[t]=y(e%s*i,Math.floor(e/s)*o);return{tex:e,map:a,qw:i,qh:o}}function c(e,t,r=n.defTex,s=n.defProg,i={}){r=null!=r?r:n.defTex,s=null!=s?s:n.defProg,(r!==n.curTex||s!==n.curProg||!U(n.curUniform,i)||n.vqueue.length+e.length*W>G||n.iqueue.length+t.length>G)&&d(),n.curTex=r,n.curProg=s,n.curUniform=i;let o=t.map((e=>e+n.vqueue.length/W)),a=e.map((e=>{let t=g(n.transform.multVec2(e.pos.xy()));return[t.x,t.y,e.pos.z,e.uv.x,e.uv.y,e.color.r,e.color.g,e.color.b,e.color.a]})).flat();o.forEach((e=>n.iqueue.push(e))),a.forEach((e=>n.vqueue.push(e)))}function d(){!n.curTex||!n.curProg||0===n.vqueue.length||0===n.iqueue.length||(n.curProg.send(n.curUniform),e.bindBuffer(e.ARRAY_BUFFER,n.vbuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(n.vqueue)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.ibuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(n.iqueue)),n.curProg.bind(),n.curProg.bindAttribs(),n.curTex.bind(),e.drawElements(e.TRIANGLES,n.iqueue.length,e.UNSIGNED_SHORT,0),n.curTex.unbind(),n.curProg.unbind(),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),n.iqueue=[],n.vqueue=[],n.drawCalls++)}function f(){e.clear(e.COLOR_BUFFER_BIT),t.clearColor||F({width:Y(),height:j(),quad:P(0,0,Y()*H()/V,j()*H()/V),tex:n.bgTex}),n.drawCalls=0,n.transformStack=[],n.transform=E()}function m(){d(),n.lastDrawCalls=n.drawCalls}function p(){return n.lastDrawCalls}function g(e){return y(e.x/Y()*2-1,-e.y/j()*2+1)}function v(e){n.transform=e.clone()}function A(e){!e||0===e.x&&0===e.y||(n.transform=n.transform.translate(e))}function T(e){!e||1===e.x&&1===e.y||(n.transform=n.transform.scale(e))}function _(e){!e||(n.transform=n.transform.rotateZ(e))}function D(){n.transformStack.push(n.transform.clone())}function M(){n.transformStack.length>0&&(n.transform=n.transformStack.pop())}function F(e={}){var t,r;let n=e.width||0,s=e.height||0,i=e.pos||y(0,0),o=z(e.origin||J).dot(y(n,s).scale(-.5)),a=y(null!=(t=e.scale)?t:1),l=e.rot||0,u=e.quad||P(0,0,1,1),h=1-(null!=(r=e.z)?r:0),d=e.color||R(1,1,1,1);D(),A(i),T(a),_(l),A(o),c([{pos:w(-n/2,s/2,h),uv:y(u.x,u.y+u.h),color:d},{pos:w(-n/2,-s/2,h),uv:y(u.x,u.y),color:d},{pos:w(n/2,-s/2,h),uv:y(u.x+u.w,u.y),color:d},{pos:w(n/2,s/2,h),uv:y(u.x+u.w,u.y+u.h),color:d}],[0,1,3,1,2,3],e.tex,e.prog,e.uniform),M()}function I(e,t={}){var r;let n=null!=(r=t.quad)?r:P(0,0,1,1),s=e.width*n.w,i=e.height*n.h;F(l(a({},t),{tex:e,quad:n,width:s,height:i}))}function L(e,t,r,n={}){F(l(a({},n),{pos:e,width:t,height:r}))}function C(e,t,r,n={}){let s=z(n.origin||J).dot(y(t,r)).scale(.5),i=e.add(y(-t/2,-r/2)).sub(s),o=e.add(y(-t/2,r/2)).sub(s),a=e.add(y(t/2,r/2)).sub(s),l=e.add(y(t/2,-r/2)).sub(s);q(i,o,n),q(o,a,n),q(a,l,n),q(l,i,n)}function q(e,t,r={}){let n=r.width||1,s=e.dist(t),i=Math.PI/2-e.angle(t);F(l(a({},r),{pos:e.add(t).scale(.5),width:n,height:s,rot:i,origin:"center"}))}function B(e,t,r={}){let n=(e+"").split(""),s=t.qw*t.tex.width,i=t.qh*t.tex.height,o=y((r.size||i)/i).dot(y(r.scale||1)),a=o.x*s,l=o.y*i,u=0,h=l,c=0,d=[[]];for(let e of n)("\n"===e||!!r.width&&u+a>r.width)&&(h+=l,u=0,d.push([])),"\n"!==e&&(d[d.length-1].push(e),u+=a),c=Math.max(c,u);r.width&&(c=r.width);let f=[],m=y(r.pos||0),p=z(r.origin||J).scale(.5),g=-p.x*a-(p.x+.5)*(c-a),v=-p.y*l-(p.y+.5)*(h-l);return d.forEach(((e,n)=>{let s=(c-e.length*a)*(p.x+.5);e.forEach(((e,i)=>{let u=t.map[e],h=i*a,c=n*l;u&&f.push({tex:t.tex,quad:P(u.x,u.y,t.qw,t.qh),ch:e,pos:y(m.x+h+g+s,m.y+c+v),color:r.color,origin:r.origin,scale:o,z:r.z})}))})),{width:c,height:h,chars:f}}function O(e,t,r={}){N(B(e,t,r))}function N(e){for(let t of e.chars)F({tex:t.tex,width:t.tex.width*t.quad.w,height:t.tex.height*t.quad.h,pos:t.pos,scale:t.scale,color:t.color,quad:t.quad,origin:"center",z:t.z})}function Y(){return e.drawingBufferWidth/H()}function j(){return e.drawingBufferHeight/H()}function H(){var e;return null!=(e=t.scale)?e:1}function X(){return n.clearColor.clone()}return f(),m(),u(s,"powerOfTwo"),u(i,"makeTex"),u(o,"makeProgram"),u(h,"makeFont"),u(c,"drawRaw"),u(d,"flush"),u(f,"frameStart"),u(m,"frameEnd"),u(p,"drawCalls"),u(g,"toNDC"),u(v,"pushMatrix"),u(A,"pushTranslate"),u(T,"pushScale"),u((function(e){!e||(n.transform=n.transform.rotateX(e))}),"pushRotateX"),u((function(e){!e||(n.transform=n.transform.rotateY(e))}),"pushRotateY"),u(_,"pushRotateZ"),u(D,"pushTransform"),u(M,"popTransform"),u(F,"drawQuad"),u(I,"drawTexture"),u(L,"drawRect"),u(C,"drawRectStroke"),u(q,"drawLine"),u(B,"fmtText"),u(O,"drawText"),u(N,"drawFmtText"),u(Y,"width"),u(j,"height"),u(H,"scale"),u(X,"clearColor"),{width:Y,height:j,scale:H,makeTex:i,makeProgram:o,makeFont:h,drawTexture:I,drawText:O,drawFmtText:N,drawRect:L,drawRectStroke:C,drawLine:q,fmtText:B,frameStart:f,frameEnd:m,pushTransform:D,popTransform:M,pushMatrix:v,drawCalls:p,clearColor:X}}var J,W,G,V,K,Q,$,Z,ee=h((()=>{j(),H(),J="topleft",W=9,G=65536,V=64,K="\nattribute vec3 a_pos;\nattribute vec2 a_uv;\nattribute vec4 a_color;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nvec4 def_vert() {\n\treturn vec4(a_pos, 1.0);\n}\n\n{{user}}\n\nvoid main() {\n\tvec4 pos = vert(a_pos, a_uv, a_color);\n\tv_pos = a_pos;\n\tv_uv = a_uv;\n\tv_color = a_color;\n\tgl_Position = pos;\n}\n",Q="\nprecision mediump float;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nuniform sampler2D u_tex;\n\nvec4 def_frag() {\n\treturn v_color * texture2D(u_tex, v_uv);\n}\n\n{{user}}\n\nvoid main() {\n\tgl_FragColor = frag(v_pos, v_uv, v_color, u_tex);\n\tif (gl_FragColor.a == 0.0) {\n\t\tdiscard;\n\t}\n}\n",$="\nvec4 vert(vec3 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n",Z="\nvec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n",u(z,"originPt"),u(X,"gfxInit")}));function te(e){return"pressed"===e||"rpressed"===e?"down":"released"===e?"up":e}function re(e={}){var t,r;let n={canvas:null!=(t=e.canvas)?t:(()=>{var t;let r=document.createElement("canvas");return(null!=(t=e.root)?t:document.body).appendChild(r),r})(),keyStates:{},charInputted:[],mouseState:"up",mousePos:y(0,0),time:0,realTime:0,skipTime:!1,dt:0,scale:null!=(r=e.scale)?r:1,isTouch:!1,loopID:null,stopped:!1,fps:0,fpsBuf:[],fpsTimer:0},s={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},i=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11"];e.fullscreen?(n.canvas.width=window.innerWidth,n.canvas.height=window.innerHeight):(n.canvas.width=(e.width||640)*n.scale,n.canvas.height=(e.height||480)*n.scale);let o=["outline: none","cursor: default"];e.crisp&&(o.push("image-rendering: pixelated"),o.push("image-rendering: crisp-edges")),n.canvas.style=o.join(";"),n.canvas.setAttribute("tabindex","0");let a=n.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});function l(){return n.mousePos.clone()}function h(){return"pressed"===n.mouseState}function c(){return"pressed"===n.mouseState||"down"===n.mouseState}function d(){return"released"===n.mouseState}function f(e){return"pressed"===n.keyStates[e]}function m(e){return"pressed"===n.keyStates[e]||"rpressed"===n.keyStates[e]}function p(e){return"pressed"===n.keyStates[e]||"rpressed"===n.keyStates[e]||"down"===n.keyStates[e]}function g(e){return"released"===n.keyStates[e]}function v(){return[...n.charInputted]}function w(){return n.dt}function x(){return n.time}function b(){return n.fps}function k(){return n.canvas.toDataURL()}function S(e){return e&&(n.canvas.style.cursor=null!=e?e:"default"),n.canvas.style.cursor}function A(e){let t=u((r=>{let s=r/1e3,i=s-n.realTime;n.realTime=s,n.skipTime||(n.dt=i,n.time+=n.dt,n.fpsBuf.push(1/n.dt),n.fpsTimer+=n.dt,n.fpsTimer>=1&&(n.fpsTimer=0,n.fps=Math.round(n.fpsBuf.reduce(((e,t)=>e+t))/n.fpsBuf.length),n.fpsBuf=[])),n.skipTime=!1,e();for(let e in n.keyStates)n.keyStates[e]=te(n.keyStates[e]);n.mouseState=te(n.mouseState),n.charInputted=[],n.stopped||(n.loopID=requestAnimationFrame(t))}),"frame");n.loopID=requestAnimationFrame(t)}function R(){cancelAnimationFrame(n.loopID),n.stopped=!0}return n.isTouch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,n.canvas.addEventListener("mousemove",(e=>{n.mousePos=y(e.offsetX,e.offsetY).scale(1/n.scale)})),n.canvas.addEventListener("mousedown",(()=>{n.mouseState="pressed"})),n.canvas.addEventListener("mouseup",(()=>{n.mouseState="released"})),n.canvas.addEventListener("touchstart",(e=>{let t=e.touches[0];n.mousePos=y(t.clientX,t.clientY).scale(1/n.scale),n.mouseState="pressed"})),n.canvas.addEventListener("touchmove",(e=>{let t=e.touches[0];n.mousePos=y(t.clientX,t.clientY).scale(1/n.scale)})),n.canvas.addEventListener("keydown",(e=>{let t=s[e.key]||e.key.toLowerCase();i.includes(t)&&e.preventDefault(),1===t.length&&n.charInputted.push(t),"space"===t&&n.charInputted.push(" "),e.repeat?n.keyStates[t]="rpressed":n.keyStates[t]="pressed"})),n.canvas.addEventListener("keyup",(e=>{let t=s[e.key]||e.key.toLowerCase();n.keyStates[t]="released"})),n.canvas.focus(),document.addEventListener("visibilitychange",(()=>{switch(document.visibilityState){case"visible":n.skipTime=!0}})),u(l,"mousePos"),u(h,"mouseClicked"),u(c,"mouseDown"),u(d,"mouseReleased"),u(f,"keyPressed"),u(m,"keyPressedRep"),u(p,"keyDown"),u(g,"keyReleased"),u(v,"charInputted"),u(w,"dt"),u(x,"time"),u(b,"fps"),u(k,"screenshot"),u(S,"cursor"),u(A,"run"),u(R,"quit"),{gl:a,mousePos:l,keyDown:p,keyPressed:f,keyPressedRep:m,keyReleased:g,mouseDown:c,mouseClicked:h,mouseReleased:d,charInputted:v,cursor:S,dt:w,time:x,fps:b,screenshot:k,run:A,quit:R}}var ne=h((()=>{j(),u(te,"processBtnState"),u(re,"appInit")}));function se(){let e=(()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain(),r=t;return r.connect(e.destination),{ctx:e,gainNode:t,masterNode:r}})();function t(t){return void 0!==t&&(e.gainNode.gain.value=f(t,ie,oe)),e.gainNode.gain.value}function r(t,r={loop:!1,volume:1,speed:1,detune:0,seek:0}){var n;let s=!1,i=e.ctx.createBufferSource();i.buffer=t,i.loop=!!r.loop;let o=e.ctx.createGain();i.connect(o),o.connect(e.masterNode);let a=null!=(n=r.seek)?n:0;i.start(0,a);let l=e.ctx.currentTime-a,u=null,h={stop(){s||(this.pause(),l=e.ctx.currentTime)},play(t){if(!s)return;let r=i;i=e.ctx.createBufferSource(),i.buffer=r.buffer,i.loop=r.loop,i.playbackRate.value=r.playbackRate.value,i.detune&&(i.detune.value=r.detune.value),i.connect(o);let n=null!=t?t:this.time();i.start(0,n),l=e.ctx.currentTime-n,s=!1,u=null},pause(){s||(i.stop(),s=!0,u=e.ctx.currentTime)},paused:()=>s,stopped:()=>s,speed:e=>(void 0!==e&&(i.playbackRate.value=f(e,ae,le)),i.playbackRate.value),detune:e=>i.detune?(void 0!==e&&(i.detune.value=f(e,ue,he)),i.detune.value):0,volume:e=>(void 0!==e&&(o.gain.value=f(e,ie,oe)),o.gain.value),loop(){i.loop=!0},unloop(){i.loop=!1},duration:()=>t.duration,time:()=>s?u-l:e.ctx.currentTime-l};return h.speed(r.speed),h.detune(r.detune),h.volume(r.volume),h}function n(){return e.ctx}return u(t,"volume"),u(r,"play"),u(n,"ctx"),{ctx:n,volume:t,play:r}}var ie,oe,ae,le,ue,he,ce,de=h((()=>{j(),ie=0,oe=3,ae=0,le=3,ue=-1200,he=1200,u(se,"audioInit")})),fe=h((()=>{ce="data:image/png;base64,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"}));function me(e){let t=new Image;return t.src=e,t.crossOrigin="anonymous",new Promise(((r,n)=>{t.onload=()=>{r(t)},t.onerror=()=>{n(`failed to load ${e}`)}}))}function pe(e){return e.startsWith("data:")}function ge(e,t,r={}){let n={lastLoaderID:0,loadRoot:"",loaders:{},sprites:{},sounds:{},fonts:{},shaders:{}};function s(e){var t;let s=n.lastLoaderID;n.loaders[s]=!1,n.lastLoaderID++,e.catch(null!=(t=r.errHandler)?t:console.error).finally((()=>{n.loaders[s]=!0}))}function i(){let e=0,t=0;for(let r in n.loaders)e+=1,n.loaders[r]&&(t+=1);return t/e}function o(e){return e&&(n.loadRoot=e),n.loadRoot}function a(t,r,i,o,a=ye){let l=new Promise(((s,l)=>{me(pe(r)?r:n.loadRoot+r).then((r=>{let l=e.makeFont(e.makeTex(r),i,o,a);n.fonts[t]=l,s(l)})).catch(l)}));return s(l),l}function l(t,r,i={sliceX:1,sliceY:1,anims:{}}){function o(t,r,s={sliceX:1,sliceY:1,gridWidth:0,gridHeight:0,anims:{}}){let i=[],o=e.makeTex(r),a=s.sliceX||o.width/(s.gridWidth||o.width),l=s.sliceY||o.height/(s.gridHeight||o.height),u=1/a,h=1/l;for(let e=0;e<l;e++)for(let t=0;t<a;t++)i.push(P(t*u,e*h,u,h));let c={tex:o,frames:i,anims:s.anims||{}};return n.sprites[t]=c,c}u(o,"loadRawSprite");let a=new Promise(((e,s)=>{if(!r)return s(`expected sprite src for "${t}"`);"string"==typeof r?me(pe(r)?r:n.loadRoot+r).then((r=>{e(o(t,r,i))})).catch(s):e(o(t,r,i))}));return s(a),a}function h(t,r,i,o=!1){function a(t,r,s){let i=e.makeProgram(r,s);return n.shaders[t]=i,i}u(a,"loadRawShader");let l=new Promise(((e,s)=>{if(!r&&!i)return s("no shader");function l(e){return e?fetch(n.loadRoot+e).then((t=>{if(t.ok)return t.text();throw new Error(`failed to load ${e}`)})).catch(s):new Promise((e=>e(null)))}if(u(l,"resolveUrl"),o)Promise.all([l(r),l(i)]).then((([r,n])=>{e(a(t,r,n))})).catch(s);else try{e(a(t,r,i))}catch(e){s(e)}}));return s(l),l}function c(e,r){let i=n.loadRoot+r,o=new Promise(((s,o)=>{if(!r)return o(`expected sound src for "${e}"`);"string"==typeof r&&fetch(i).then((e=>{if(e.ok)return e.arrayBuffer();throw new Error(`failed to load ${i}`)})).then((e=>new Promise(((r,n)=>{t.ctx().decodeAudioData(e,r,n)})))).then((t=>{n.sounds[e]=t,s(t)})).catch(o)}));return s(o),o}function d(){return n.fonts[ve]}return u(s,"addLoader"),u(i,"loadProgress"),u(o,"loadRoot"),u(a,"loadFont"),u(l,"loadSprite"),u(h,"loadShader"),u(c,"loadSound"),u(d,"defFont"),a(ve,ce,8,8),{loadRoot:o,loadSprite:l,loadSound:c,loadFont:a,loadShader:h,loadProgress:i,addLoader:s,defFont:d,sprites:n.sprites,fonts:n.fonts,sounds:n.sounds,shaders:n.shaders}}var ye,ve,we=h((()=>{j(),fe(),ye=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",ve="unscii",u(me,"loadImg"),u(pe,"isDataUrl"),u(ge,"assetsInit")}));function xe(e,t,r={max:8}){var n;let s=[],i=null!=(n=r.max)?n:8;function o(){s.length>i&&(s=s.slice(0,i));let r=y(0,e.height());s.forEach(((n,s)=>{let o=p(s,0,i,1,.5),a=p(s,0,i,.8,.2),l=(()=>{switch(n.type){case"info":return R(1,1,1,o);case"error":return R(1,0,.5,o)}})(),u=e.fmtText(n.msg,t.defFont(),{pos:r,origin:"botleft",color:l,size:be/e.scale(),width:e.width()});e.drawRect(r,u.width,u.height,{origin:"botleft",color:R(0,0,0,a)}),e.drawFmtText(u),r.y-=u.height}))}function a(e){console.error(e),s.unshift({type:"error",msg:e})}function l(e){s.unshift({type:"info",msg:e})}function h(){s=[]}return u(o,"draw"),u(a,"error"),u(l,"info"),u(h,"clear"),{info:l,error:a,draw:o,clear:h}}var be,ke=h((()=>{j(),be=16,u(xe,"loggerInit")}));function Se(e){let t={},r=[],n=null;function s(){return null!==n&&1===n.readyState}function i(){let s=new WebSocket(e);return new Promise(((i,o)=>{s.onopen=()=>{i(s),n=s;for(let e of r)s.send(e)},s.onerror=()=>{o(`failed to connect to ${e}`)},s.onmessage=e=>{let r=JSON.parse(e.data);if(t[r.type])for(let e of t[r.type])e(r.data,r.id)}}))}function o(e,r){t[e]||(t[e]=[]),t[e].push(r)}function a(e,t){let s=JSON.stringify({type:e,data:t});n?n.send(s):r.push(s)}function l(){n&&n.close()}return u(s,"connected"),u(i,"connect"),u(o,"recv"),u(a,"send"),u(l,"close"),{connect:i,close:l,connected:s,recv:o,send:a}}var Ae,Re,Pe=h((()=>{u(Se,"netInit")}));const Ee=(Ae=(e,t)=>{j(),ee(),ne(),de(),we(),ke(),Pe(),t.exports=(e={width:640,height:480,scale:1,fullscreen:!1,debug:!1,crisp:!1,canvas:null,connect:null,logMax:8,root:document.body})=>{let t=re({width:e.width,height:e.height,scale:e.scale,fullscreen:e.fullscreen,crisp:e.crisp,canvas:e.canvas,root:e.root}),r=X(t.gl,{clearColor:e.clearColor?R(e.clearColor):void 0,scale:e.scale,texFilter:e.texFilter}),n=se(),s=ge(r,n,{errHandler:e=>{i.error(e)}}),i=xe(r,s,{max:e.logMax}),o=e.connect?Se(e.connect):null;function h(e,t){if(!o)throw new Error("not connected to any websockets");o.recv(e,((e,r)=>{try{t(e,r)}catch(e){i.error(e)}}))}function w(e,t){if(!o)throw new Error("not connected to any websockets");o.send(e,t)}function x(){return t.dt()*Qe.timeScale}function b(e,t={}){let r=s.sounds[e];if(!r)throw new Error(`sound not found: "${e}"`);return n.play(r,t)}function k(e){var t;let r=j();return!(null==(t=r.layers[null!=e?e:r.defLayer])?void 0:t.noCam)}function S(e){return k(e)?j().cam.mpos:t.mousePos()}function B(e,t={}){var n;let i="string"==typeof e?s.sprites[e]:e;if(!i)throw new Error(`sprite not found: "${e}"`);let o=i.frames[null!=(n=t.frame)?n:0];r.drawTexture(i.tex,l(a({},t),{quad:o}))}function O(e,t={}){var n;let i=null!=(n=t.font)?n:ve,o=s.fonts[i];if(!o)throw new Error(`font not found: ${i}`);r.drawText(e,o,t)}u(h,"recv"),u(w,"send"),u(x,"dt"),u(b,"play"),u(k,"isCamLayer"),u(S,"mousePos"),u(B,"drawSprite"),u(O,"drawText");let N={loaded:!1,scenes:{},curScene:null,nextScene:null};function Y(e,t){N.scenes[e]={init:t,initialized:!1,events:{add:[],update:[],draw:[],destroy:[],keyDown:[],keyPress:[],keyPressRep:[],keyRelease:[],mouseClick:[],mouseRelease:[],mouseDown:[],charInput:[]},action:[],render:[],objs:new Map,lastObjID:0,timers:{},lastTimerID:0,cam:{pos:y(r.width()/2,r.height()/2),scale:y(1,1),angle:0,shake:0,mpos:y(0),matrix:E()},layers:{},defLayer:null,gravity:980,data:{}}}function j(){return N.scenes[N.curScene]}function U(){return j().data}function H(){pe("`",(()=>{Qe.showLog=!Qe.showLog,i.info("show log: "+(Qe.showLog?"on":"off"))})),pe("f1",(()=>{Qe.inspect=!Qe.inspect,i.info("inspect: "+(Qe.inspect?"on":"off"))})),pe("f2",(()=>{Qe.clearLog()})),pe("f8",(()=>{Qe.paused=!Qe.paused,i.info(Qe.paused?"paused":"unpaused")})),pe("f7",(()=>{Qe.timeScale=f(Qe.timeScale-.2,0,2),i.info(`time scale: ${Qe.timeScale.toFixed(1)}`)})),pe("f9",(()=>{Qe.timeScale=f(Qe.timeScale+.2,0,2),i.info(`time scale: ${Qe.timeScale.toFixed(1)}`)})),pe("f10",(()=>{Qe.stepFrame(),i.info("stepped frame")}))}function J(e,...t){N.nextScene={name:e,args:[...t]}}function W(t,...r){G(t),N.curScene=t;let n=N.scenes[t];if(!n)throw new Error(`scene not found: '${t}'`);if(!n.initialized){try{n.init(...r)}catch(e){i.error(e.stack)}e.debug&&H(),n.initialized=!0}}function G(e){if(!N.scenes[e])throw new Error(`scene not found: '${e}'`);Y(e,N.scenes[e].init)}function V(e,t){let r=j();!r||(e.forEach(((e,t)=>{r.layers[e]={alpha:1,order:t+1,noCam:!1}})),t&&(r.defLayer=t))}function K(...e){let t=j().cam;return e.length>0&&(t.pos=y(...e)),t.pos.clone()}function Q(...e){let t=j().cam;return e.length>0&&(t.scale=y(...e)),t.scale.clone()}function $(e){let t=j().cam;return void 0!==e&&(t.angle=e),t.angle}function Z(e){j().cam.shake=e}function ee(e){let t=j();e.forEach((e=>{t.layers[e]&&(t.layers[e].noCam=!0)}))}function te(e){let t={hidden:!1,paused:!1,_tags:[],_id:null,_events:{add:[],update:[],draw:[],destroy:[],inspect:[]},use(e){if(void 0===e)return;let t=typeof e;if("string"!==t){if("object"!==t)throw new Error(`invalid comp type: ${t}`);if(Array.isArray(e))for(let t of e)this.use(t);else for(let t in e)"function"!=typeof e[t]?this[t]=e[t]:this._events[t]?this._events[t].push(e[t].bind(this)):this[t]=e[t].bind(this)}else this._tags.push(e)},exists(){return void 0!==this._id},is(e){if("*"===e)return!0;if(Array.isArray(e)){for(let t of e)if(!this._tags.includes(t))return!1;return!0}return this._tags.includes(e)},on(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},action(e){this.on("update",e)},trigger(e,...t){if(this._events[e])for(let r of this._events[e])r.call(this,...t);let r=j().events[e];if(r)for(let e of r)this.is(e.tag)&&e.cb(this,...t)},rmTag(e){let t=this._tags.indexOf(e);t>-1&&this._tags.splice(t,1)}};t.use(e);let r=j(),n=r.lastObjID++;r.objs.set(n,t),t._id=n,t.trigger("add");for(let e of r.events.add)t.is(e.tag)&&e.cb(t);return t}function ne(e){if(!e.exists())return;let t=j();t.objs.delete(e._id);let r=t.lastObjID++;return t.objs.set(r,e),e._id=r,e}function ie(e,t,r){let n=j();n.events[e]||(n.events[e]=[]),n.events[e].push({tag:t,cb:r})}function oe(e,t){"function"==typeof e&&void 0===t?j().action.push(e):"string"==typeof e&&ie("update",e,t)}function ae(e,t){"function"==typeof e&&void 0===t?j().render.push(e):"string"==typeof e&&ie("update",e,t)}function le(e,t,r){oe(e,(e=>{e._checkCollisions(t,(t=>{r(e,t)}))}))}function ue(e,t,r){oe(e,(e=>{e._checkOverlaps(t,(t=>{r(e,t)}))}))}function he(e,t){oe(e,(e=>{e.isClicked()&&t(e)}))}function ce(e,t){return new Promise((r=>{let n=j();n.timers[n.lastTimerID++]={time:e,cb:()=>{t&&t(),r()}}}))}function de(e,t){let r=!1,n=u((()=>{r||(t(),ce(e,n))}),"newF");return n(),{stop(){r=!0}}}function fe(e,t,r){if(Array.isArray(t))for(let n of t)fe(e,n,r);else j().events[e].push({key:t,cb:r})}function me(e,t){fe("keyDown",e,t)}function pe(e,t){fe("keyPress",e,t)}function ye(e,t){fe("keyPressRep",e,t)}function we(e,t){fe("keyRelease",e,t)}function be(e){j().events.charInput.push({cb:e})}function ke(e){j().events.mouseDown.push({cb:e})}function Ae(e){j().events.mouseClick.push({cb:e})}function Re(e){j().events.mouseRelease.push({cb:e})}function Pe(e){let t=j(),r=[...t.objs.values()].sort(((e,r)=>{var n,s,i,o,a,l;return(null!=(i=null==(s=t.layers[null!=(n=e.layer)?n:t.defLayer])?void 0:s.order)?i:0)-(null!=(l=null==(a=t.layers[null!=(o=r.layer)?o:t.defLayer])?void 0:a.order)?l:0)}));return e?r.filter((t=>t.is(e))):r}function Ee(e,t){"function"==typeof e&&void 0===t?Pe().forEach(e):"string"==typeof e&&Pe(e).forEach(t)}function Te(e,t){"function"==typeof e&&void 0===t?Pe().reverse().forEach(e):"string"==typeof e&&Pe(e).reverse().forEach(t)}function _e(e){if(!e.exists())return;let t=j();!t||(e.trigger("destroy"),t.objs.delete(e._id),delete e._id)}function De(e){Ee(e,(e=>{_e(e)}))}function Me(e){let t=j();return void 0!==e&&(t.gravity=e),t.gravity}function Fe(e){let n=j();if(!n)throw new Error(`scene not found: '${N.curScene}'`);let s=e||!Qe.paused;if(s)for(let e in n.timers){let t=n.timers[e];t.time-=x(),t.time<=0&&(t.cb(),delete n.timers[e])}if(Te((e=>{!e.paused&&s&&e.trigger("update")})),s)for(let e of n.action)e();let i=y(r.width(),r.height()),o=n.cam,a=v(M(0,2*Math.PI)).scale(o.shake);o.shake=m(o.shake,0,5*x()),o.matrix=E().translate(i.scale(.5)).scale(o.scale).rotateZ(o.angle).translate(i.scale(-.5)).translate(o.pos.scale(-1).add(i.scale(.5)).add(a)),o.mpos=o.matrix.invert().multVec2(t.mousePos()),Ee((e=>{e.hidden||(r.pushTransform(),k(e.layer)&&r.pushMatrix(o.matrix),e.trigger("draw"),r.popTransform())}));for(let e of n.render)e()}function Ie(){let e=j();for(let r of e.events.charInput)t.charInputted().forEach(r.cb);for(let r of e.events.keyDown)t.keyDown(r.key)&&r.cb();for(let r of e.events.keyPress)t.keyPressed(r.key)&&r.cb();for(let r of e.events.keyPressRep)t.keyPressedRep(r.key)&&r.cb();for(let r of e.events.keyRelease)t.keyReleased(r.key)&&r.cb();for(let r of e.events.mouseDown)t.mouseDown()&&r.cb();for(let r of e.events.mouseClick)t.mouseClicked()&&r.cb();for(let r of e.events.mouseRelease)t.mouseReleased()&&r.cb()}function Le(){var n;let i=j(),o=null,a=s.defFont(),l=R(null!=(n=e.inspectColor)?n:[0,1,1,1]);function h(e,t,n){let s=y(4).scale(1/n),i=r.fmtText(t,a,{size:12/n,pos:e.add(y(s.x,s.y))});r.drawRect(e,i.width+2*s.x,i.height+2*s.x,{color:R(0,0,0,1)}),r.drawFmtText(i)}function c(e,t){let n=k(e.layer),s=r.scale()*(n?(i.cam.scale.x+i.cam.scale.y)/2:1);n&&(r.pushTransform(),r.pushMatrix(i.cam.matrix)),t(s),n&&r.popTransform()}u(h,"drawInspectTxt"),u(c,"drawObj"),Te((e=>{!e.area||e.hidden||c(e,(t=>{o||e.isHovered()&&(o=e);let n=(o===e?6:2)/t,s=e._worldArea(),i=s.p2.x-s.p1.x,a=s.p2.y-s.p1.y;r.drawRectStroke(s.p1,i,a,{width:n,color:l})}))})),o&&c(o,(e=>{let t=S(o.layer),r=[];for(let e of o._tags)r.push(`"${e}"`);for(let e of o._events.inspect){let t=e();for(let e in t)r.push(`${e}: ${t[e]}`)}h(t,r.join("\n"),e)})),h(y(0),t.fps()+"",r.scale())}function Ce(e,...n){t.run((()=>{if(r.frameStart(),N.loaded){try{if(!j())throw new Error(`scene not found: '${N.curScene}'`);Ie(),Fe(),Qe.inspect&&Le()}catch(e){i.error(e.stack),t.quit()}Qe.showLog&&i.draw(),N.nextScene&&(W.apply(null,[N.nextScene.name,...N.nextScene.args]),N.nextScene=null)}else{let t=s.loadProgress();if(1===t)N.loaded=!0,W(e,...n),o&&o.connect().catch(i.error);else{let e=r.width()/2,n=24/r.scale(),s=y(r.width()/2,r.height()/2).sub(y(e/2,n/2));r.drawRect(y(0),r.width(),r.height(),{color:A(0,0,0)}),r.drawRectStroke(s,e,n,{width:4/r.scale()}),r.drawRect(s,e*t,n)}}r.frameEnd()}))}function qe(...e){return{pos:y(...e),move(...e){let t=y(...e),r=t.x*x(),n=t.y*x();this.pos.x+=r,this.pos.y+=n},inspect(){return{pos:`(${~~this.pos.x}, ${~~this.pos.y})`}}}}function Be(...e){return 0===e.length?Be(1):{scale:y(...e),flipX(e){this.scale.x=Math.sign(e)*Math.abs(this.scale.x)},flipY(e){this.scale.y=Math.sign(e)*Math.abs(this.scale.y)}}}function Oe(e){return{angle:null!=e?e:0}}function Ne(...e){return{color:R(...e)}}function Ye(e){return{origin:e}}function je(e){return{layer:e,inspect(){var e;let t=j();return{layer:null!=(e=this.layer)?e:t.defLayer}}}}function Ue(e,t){var r,n;let s=j();return(null!=(r=e.layer)?r:s.defLayer)===(null!=(n=t.layer)?n:s.defLayer)}function He(e,r){let n={},s={};return{area:{p1:e,p2:r},areaWidth(){let{p1:e,p2:t}=this._worldArea();return t.x-e.x},areaHeight(){let{p1:e,p2:t}=this._worldArea();return t.y-e.y},isClicked(){return t.mouseClicked()&&this.isHovered()},isHovered(){return this.hasPt(S(this.layer))},isCollided(e){return!(!e.area||!Ue(this,e))&&L(this._worldArea(),e._worldArea())},isOverlapped(e){return!(!e.area||!Ue(this,e))&&C(this._worldArea(),e._worldArea())},clicks(e){this.action((()=>{this.isClicked()&&e()}))},hovers(e){this.action((()=>{this.isHovered()&&e()}))},collides(e,t){this.action((()=>{this._checkCollisions(e,t)}))},overlaps(e,t){this.action((()=>{this._checkOverlaps(e,t)}))},hasPt(e){let t=this._worldArea();return q({p1:t.p1,p2:t.p2},e)},resolve(){let e=[];return Ee((t=>{if(t===this||!t.solid||!t.area||!Ue(this,t))return;let r=this._worldArea(),n=t._worldArea();if(!L(r,n))return;let s=r.p2.x-n.p1.x,i=n.p2.x-r.p1.x,o=r.p2.y-n.p1.y,a=n.p2.y-r.p1.y,l=Math.min(s,i,o,a),u=(()=>{switch(l){case s:return this.pos.x-=s,"right";case i:return this.pos.x+=i,"left";case o:return this.pos.y-=o,"bottom";case a:return this.pos.y+=a,"top"}})();e.push({obj:t,side:u})})),e},_checkCollisions(e,t){Ee(e,(e=>{this!==e&&(n[e._id]||this.isCollided(e)&&(t(e),n[e._id]=e))}));for(let e in n){let t=n[e];this.isCollided(t)||delete n[e]}},_checkOverlaps(e,t){Ee(e,(e=>{this!==e&&(s[e._id]||this.isOverlapped(e)&&(t(e),s[e._id]=e))}));for(let e in s){let t=s[e];this.isOverlapped(t)||delete s[e]}},_worldArea(){let e=this.area,t=this.pos||y(0),r=this.scale||y(1),n=t.add(e.p1.dot(r)),s=t.add(e.p2.dot(r));return{p1:y(Math.min(n.x,s.x),Math.min(n.y,s.y)),p2:y(Math.max(n.x,s.x),Math.max(n.y,s.y))}}}}function ze(e,t,r){let n=y(e,t),s=z(r||"topleft").dot(n).scale(-.5);return He(s.sub(n.scale(.5)),s.add(n.scale(.5)))}function Xe(e,t={}){let r=s.sprites[e];if(!r)throw new Error(`sprite not found: "${e}"`);let n=a({},r.frames[0]);t.quad&&(n.x+=t.quad.x*n.w,n.y+=t.quad.y*n.h,n.w*=t.quad.w,n.h*=t.quad.h);let i=r.tex.width*n.w,o=r.tex.height*n.h,l=null;return{width:i,height:o,animSpeed:t.animSpeed||.1,frame:t.frame||0,quad:t.quad||P(0,0,1,1),add(){!this.area&&!t.noArea&&this.use(ze(this.width,this.height,this.origin))},draw(){j(),r.frames[this.frame],B(r,{pos:this.pos,scale:this.scale,rot:this.angle,color:this.color,frame:this.frame,origin:this.origin,quad:this.quad,prog:s.shaders[this.shader],uniform:this.uniform})},update(){if(!l)return;let e=r.anims[l.name];l.timer+=x(),l.timer>=this.animSpeed&&(this.frame++,this.frame>e.to&&(l.loop?this.frame=e.from:(this.frame--,this.stop())),l&&(l.timer-=this.animSpeed))},play(e,t=!0){let n=r.anims[e];if(!n)throw new Error(`anim not found: ${e}`);l&&this.stop(),l={name:e,loop:t,timer:0},this.frame=n.from,this.trigger("animPlay",e)},stop(){if(!l)return;let e=l.name;l=null,this.trigger("animEnd",e)},changeSprite(e){if(r=s.sprites[e],!r)throw new Error(`sprite not found: "${e}"`);let n=a({},r.frames[0]);t.quad&&(n.x+=t.quad.x*n.w,n.y+=t.quad.y*n.h,n.w*=t.quad.w,n.h*=t.quad.h),this.width=r.tex.width*n.w,this.height=r.tex.height*n.h,this.area&&!t.noArea&&this.use(ze(this.width,this.height,this.origin)),l=null,this.frame=0},numFrames:()=>r.frames.length,curAnim:()=>null==l?void 0:l.name,inspect(){let e={};return l&&(e.curAnim=`"${l.name}"`),e}}}function Je(e,t,n={}){return{text:e,textSize:t,font:n.font,width:0,height:0,add(){var e,t,i;if(!this.area&&!n.noArea){j();let o=s.fonts[null!=(e=this.font)?e:ve],a=r.fmtText(this.text+"",o,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:n.width});this.width=a.width/((null==(t=this.scale)?void 0:t.x)||1),this.height=a.height/((null==(i=this.scale)?void 0:i.y)||1),this.use(ze(this.width,this.height,this.origin))}},draw(){var e;j();let t=s.fonts[null!=(e=this.font)?e:ve],i=r.fmtText(this.text+"",t,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:n.width});this.width=i.width,this.height=i.height,r.drawFmtText(i)}}}function We(e,t,n={}){return{width:e,height:t,add(){!this.area&&!n.noArea&&this.use(ze(this.width,this.height,this.origin))},draw(){j(),r.drawRect(this.pos,this.width,this.height,{scale:this.scale,rot:this.angle,color:this.color,origin:this.origin,prog:s.shaders[this.shader],uniform:this.uniform})}}}function Ge(){return{solid:!0}}function Ve(e={}){var t,r;let n=0,s=null,i=null,o=null!=(t=e.maxVel)?t:960;return{jumpForce:null!=(r=e.jumpForce)?r:480,update(){this.move(0,n);let e=this.resolve(),t=!1;if(s&&(s.exists()&&this.isCollided(s)?i&&(this.pos=this.pos.add(s.pos.sub(i)),i=s.pos.clone()):(s=null,i=null,t=!0)),!s){n=Math.min(n+Me()*x(),o);for(let r of e)"bottom"===r.side&&n>0?(s=r.obj,n=0,i=s.pos.clone(),t||this.trigger("grounded",s)):"top"===r.side&&n<0&&(n=0,this.trigger("headbump",r.obj))}},curPlatform:()=>s,grounded:()=>null!==s,falling:()=>n>0,jump(e){s=null,n=-e||-this.jumpForce}}}function Ke(e,t={}){return s.shaders[e],{shader:e,uniform:t}}u(Y,"scene"),u(j,"curScene"),u(U,"sceneData"),u(H,"regDebugInputs"),u(J,"go"),u(W,"goSync"),u(G,"reload"),u(V,"layers"),u(K,"camPos"),u(Q,"camScale"),u($,"camRot"),u(Z,"camShake"),u(ee,"camIgnore"),u(te,"add"),u(ne,"readd"),u(ie,"on"),u(oe,"action"),u(ae,"render"),u(le,"collides"),u(ue,"overlaps"),u(he,"clicks"),u(ce,"wait"),u(de,"loop"),u(fe,"pushKeyEvent"),u(me,"keyDown"),u(pe,"keyPress"),u(ye,"keyPressRep"),u(we,"keyRelease"),u(be,"charInput"),u(ke,"mouseDown"),u(Ae,"mouseClick"),u(Re,"mouseRelease"),u(Pe,"get"),u(Ee,"every"),u(Te,"revery"),u(_e,"destroy"),u(De,"destroyAll"),u(Me,"gravity"),u(Fe,"gameFrame"),u(Ie,"handleEvents"),u(Le,"drawInspect"),u(Ce,"start"),u(qe,"pos"),u(Be,"scale"),u(Oe,"rotate"),u(Ne,"color"),u(Ye,"origin"),u(je,"layer"),u(Ue,"isSameLayer"),u(He,"area"),u(ze,"getAreaFromSize"),u(Xe,"sprite"),u(Je,"text"),u(We,"rect"),u(Ge,"solid"),u(Ve,"body"),u(Ke,"shader");let Qe={paused:!1,inspect:!1,timeScale:1,showLog:!0,fps:t.fps,objCount:()=>j().objs.size,stepFrame(){Fe(!0)},drawCalls:r.drawCalls,clearLog:i.clear,log:i.info,error:i.error};function $e(e,t){let r=[],n=y(t.pos||0),s=0,i={getPos(...e){let r=y(...e);return y(n.x+r.x*t.width,n.y+r.y*t.height)},spawn(e,s){let i=(()=>{if(Array.isArray(e))return e;if(t[e]){if("function"==typeof t[e])return t[e]();if(Array.isArray(t[e]))return[...t[e]]}else if(t.any)return t.any(e)})();if(!i)return;i.push(qe(n.x+s.x*t.width,n.y+s.y*t.height));let o=te(i);return r.push(o),o.use({gridPos:s.clone(),setGridPos(e){this.gridPos=e.clone(),this.pos=y(n.x+this.gridPos.x*t.width,n.y+this.gridPos.y*t.height)},moveLeft(){this.setGridPos(this.gridPos.add(y(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(y(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(y(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(y(0,1)))}}),o},width:()=>s*t.width,height:()=>e.length*t.height,destroy(){for(let e of r)_e(e)}};return e.forEach(((e,t)=>{let r=e.split("");s=Math.max(r.length,s),r.forEach(((e,r)=>{i.spawn(e,y(r,t))}))})),i}u($e,"addLevel");let Ze={start:Ce,loadRoot:s.loadRoot,loadSprite:s.loadSprite,loadSound:s.loadSound,loadFont:s.loadFont,loadShader:s.loadShader,addLoader:s.addLoader,width:r.width,height:r.height,dt:x,time:t.time,screenshot:t.screenshot,scene:Y,go:J,sceneData:U,layers:V,camPos:K,camScale:Q,camRot:$,camShake:Z,camIgnore:ee,gravity:Me,add:te,readd:ne,destroy:_e,destroyAll:De,get:Pe,every:Ee,revery:Te,send:w,recv:h,pos:qe,scale:Be,rotate:Oe,color:Ne,origin:Ye,layer:je,area:He,sprite:Xe,text:Je,rect:We,solid:Ge,body:Ve,shader:Ke,on:ie,action:oe,render:ae,collides:le,overlaps:ue,clicks:he,keyDown:me,keyPress:pe,keyPressRep:ye,keyRelease:we,charInput:be,mouseDown:ke,mouseClick:Ae,mouseRelease:Re,mousePos:S,cursor:t.cursor,keyIsDown:t.keyDown,keyIsPressed:t.keyPressed,keyIsPressedRep:t.keyPressedRep,keyIsReleased:t.keyReleased,mouseIsDown:t.mouseDown,mouseIsClicked:t.mouseClicked,mouseIsReleased:t.mouseReleased,loop:de,wait:ce,play:b,volume:n.volume,makeRng:_,rand:M,randSeed:D,vec2:y,rgb:A,rgba:R,quad:P,choose:I,chance:F,lerp:m,map:p,mapc:g,wave:T,deg2rad:c,rad2deg:d,drawSprite:B,drawText:O,drawRect:r.drawRect,drawRectStroke:r.drawRectStroke,drawLine:r.drawLine,debug:Qe,addLevel:$e};if(e.plugins)for(let t of e.plugins){let e=t(Ze);for(let t in e)Ze[t]=e[t]}if(e.global)for(let e in Ze)window[e]=Ze[e];return Ze}},()=>(Re||Ae(Re={exports:{}},Re),Re.exports))()({width:800,height:800,scale:1,fullscreen:!1,canvas:document.getElementById("canvas"),clearColor:[0,0,0,1],debug:!0}),Te=function(e,t,r,n){return new Promise((function(s,i){s({x:e-r,y:t-n})}))};Ee.loadSprite("hades","./src/sprites/friendly/smaller.png"),Ee.loadSprite("bullet","./src/sprites/world/bullet1.png"),Ee.loadSprite("enemy","./src/sprites/enemy/enemy.png"),Ee.loadSprite("enemy2","./src/sprites/enemy/enemy2.png"),Ee.loadSprite("enemy3","./src/sprites/enemy/enemy3.png"),Ee.loadSound("shoot","./src/components/sounds/shoot.wav"),Ee.loadSprite("wall","./src/sprites/world/wall.png"),Ee.loadSprite("hello","./src/sprites/world/longwall.png"),Ee.loadSprite("vWall","./src/sprites/world/vWall.png"),Ee.loadSound("hit","./src/components/sounds/hit.wav"),Ee.loadSound("levelOneMusic","./src/components/sounds/level1music.mp3"),Ee.loadSound("level1music","./src/components/sounds/level1music.mp3"),Ee.loadSound("startMenuSound","./src/components/sounds/startMenuMusic.mp3"),Ee.scene("startScreen",(()=>{const{add:e,pos:t,color:r,go:n,play:s,scale:i,text:o,keyPress:a,charInput:l,rgba:u}=Ee,h=s("startMenuSound");h.detune(-200),h.play();var c="";console.log(c.length),a("enter",(()=>{c.length<=0?window.alert("your name fucker!"):(h.pause(),n("level1",c))})),a("backspace",(()=>{c=c.slice(0,-1),d.use(o(`Enter Your Name\n\n${c}`))})),l((e=>{c+=e,d.use(o(`Enter Your Name\n\n${c}`))}));const d=e([o(`Enter Your Name\n\n${c}`),t(275,400),r(u(1,1,1)),i(2)]);e([o("WELCOME TO HADES",9),t(256,300),r(u(1,1,1)),i(2)]),e([o("Press Enter To Start",10),t(210,600),r(u(1,1,1)),i(2)])})),Ee.scene("level1",(e=>{const{add:t,pos:r,color:n,destroy:s,camShake:i,go:o,play:a,wait:l,scale:u,sprite:h,text:c,vec2:d,rand:f,solid:m,layers:p,layer:g,rgba:y,get:v,rotate:w}=Ee;let x="up";const b=a("level1music",{volume:.4,detune:-100});b.loop(),b.play();const k=t([h("hades"),r(200,200),u(1),_(20),m(),"hades"]);p(["bg","ui","game"],"game");var S=0,A=k.hp();let R=10;const P=t([c(`${S}`),r(50,60),n(y(1,1,1)),u(2),g("ui"),"score"]),E=t([c(`${A}`),r(50,100),n(y(1,0,.3)),u(2),g("ui"),"score"]),T=t([c(`Wave :${R}`,8),r(275,50),n(y(1,0,.3)),u(2),g("ui"),"wave"]);function _(t){return{hurt(r){(t-=r)<=0&&("hades"==this._tags[0]&&(b.stop(),s(this),o("endScreen",{theScore:S,theHp:t,theName:e,outcome:!1})),s(this))},heal(e){t+=e},hp:()=>t}}function D(){S++,P.use(c(`${S}`))}Ee.keyPress("s",(()=>{x="down"})),Ee.keyPress("w",(()=>{x="up"})),Ee.keyPress("c",(()=>{crashFunction()})),Ee.keyPress("a",(()=>{x="left"})),Ee.keyPress("d",(()=>{x="right"})),Ee.keyDown("s",(()=>{k.move(0,300)})),Ee.keyDown("w",(()=>{k.move(0,-300)})),Ee.keyDown("a",(()=>{k.move(-300,0)})),Ee.keyDown("d",(()=>{k.move(300,0)})),Ee.keyPress("space",(()=>{var e;a("shoot",{volume:.6,speed:1}),e=x,t([h("bullet"),r(k.pos.x,k.pos.y),"bullet",w(1),{wDirection:e}])})),Ee.keyPress("enter",(()=>{b.stop(),M.stop(),o("level2",{theScore:S,theHp:A,theName:name})})),Ee.action("bullet",(e=>{let t=e.wDirection;"down"==t&&e.move(0,500),"up"==t&&e.move(0,-500),"left"==t&&e.move(-500,0),"right"==t&&e.move(500,0),l(.5,(()=>{s(e)}))})),Ee.action("enemy",(e=>{Te(k.pos.x,k.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),Ee.action("enemy2",(e=>{Te(k.pos.x,k.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),Ee.action("enemy3",(e=>{Te(k.pos.x,k.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),Ee.action("reset",(e=>{(e.pos.x>790||e.pos.x<0||e.pos.y>790||e.pos.y<0)&&(s(e),console.log("destryoed"))})),Ee.collides("door","hades",(()=>{b.pause(),M.stop(),o("level2",{theScore:S,theHp:A,theName:name})})),Ee.collides("reset","hades",((e,t)=>{i(12),a("hit",{volume:1,speed:1}),t.hurt(1),A--,E.use(c(`${A}`))})),Ee.collides("enemy","bullet",((e,t)=>{e.hurt(1),s(t),D()})),Ee.collides("enemy2","bullet",((e,t)=>{e.hurt(1),s(t),D()})),Ee.collides("enemy3","bullet",((e,t)=>{e.hurt(1),s(t),D()})),k.action((()=>{k.resolve()})),t([h("hello"),m(),r(0,0)]),t([h("hello"),m(),r(0,790)]),t([h("vWall"),m(),r(790,0)]),t([h("vWall"),m(),r(0,7)]);var M=Ee.loop(5,(()=>{R<1?(Ee.loop(2,(()=>{0==v("reset").length&&t([h("bullet"),r(400,400),u(2),"door"])})),M.stop()):(function(){let e=[h("enemy"),r(f(d(0),d(790))),u(3),"enemy","reset",_(2),m()];t(e)}(),function(){let e=[h("enemy2"),r(f(d(0),d(790))),u(2),"enemy2","reset",_(1),m()];t(e)}(),function(){let e=[h("enemy3"),r(f(d(10),d(790))),u(2),"enemy3","reset",_(1),m()];t(e)}(),R--,R<=0?(R=0,T.use(c(`Wave :${R}`,8))):T.use(c(`Wave :${R}`,8)))}))})),Ee.start("startScreen")})();