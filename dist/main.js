(()=>{"use strict";var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(t,s,o)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o,a=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&i(e,s,t[s]);if(o)for(var s of o(t))n.call(t,s)&&i(e,s,t[s]);return e},l=(e,o)=>t(e,s(o)),u=(t,s)=>e(t,"name",{value:s,configurable:!0}),c=(e,t)=>()=>(e&&(t=e(e=0)),t);function h(e){return e*Math.PI/180}function d(e){return 180*e/Math.PI}function p(e,t,s){return t>s?p(e,s,t):Math.min(Math.max(e,t),s)}function m(e,t,s){return e+(t-e)*s}function f(e,t,s,o,r){return o+(e-t)/(s-t)*(r-o)}function y(e,t,s,o,r){return p(f(e,t,s,o,r),o,r)}function g(...e){if(0===e.length)return g(0,0);if(1===e.length){if("number"==typeof e[0])return g(e[0],e[0]);if(x(e[0]))return g(e[0].x,e[0].y);if(Array.isArray(e[0])&&2===e[0].length)return g.apply(null,e[0])}return{x:e[0],y:e[1],clone(){return g(this.x,this.y)},add(...e){let t=g(...e);return g(this.x+t.x,this.y+t.y)},sub(...e){let t=g(...e);return g(this.x-t.x,this.y-t.y)},scale(e){return g(this.x*e,this.y*e)},dist(...e){let t=g(...e);return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},len(){return this.dist(g(0,0))},unit(){return this.scale(1/this.len())},normal(){return g(this.y,-this.x)},dot(...e){let t=g(...e);return g(this.x*t.x,this.y*t.y)},angle(...e){let t=g(...e);return Math.atan2(this.y-t.y,this.x-t.x)},lerp(e,t){return g(m(this.x,e.x,t),m(this.y,e.y,t))},eq(e){return this.x===e.x&&this.y===e.y},str(){return`(${this.x}, ${this.y})`}}}function v(e){return g(Math.cos(e),Math.sin(e))}function w(e,t,s){return{x:e,y:t,z:s,xy(){return g(this.x,this.y)}}}function x(e){return void 0!==e&&void 0!==e.x&&void 0!==e.y}function b(e){return void 0!==e&&void 0!==e.x&&void 0!==e.y&&void 0!==e.z}function k(e){return void 0!==e&&void 0!==e.r&&void 0!==e.g&&void 0!==e.b&&void 0!==e.a}function S(e){if(void 0!==e&&Array.isArray(e.m)&&16===e.m.length)return e}function P(...e){if(0===e.length)return R();if(1===e.length){if(k(e[0]))return R(e[0]);if(Array.isArray(e[0])&&3===e[0].length)return P.apply(null,e[0])}return R(e[0],e[1],e[2],1)}function R(...e){var t;if(0===e.length)return R(1,1,1,1);if(1===e.length){if(k(e[0]))return R(e[0].r,e[0].g,e[0].b,e[0].a);if(Array.isArray(e[0])&&4===e[0].length)return R.apply(null,e[0])}return{r:e[0],g:e[1],b:e[2],a:null!=(t=e[3])?t:1,clone(){return R(this.r,this.g,this.b,this.a)},lighten(e){return R(this.r+e,this.g+e,this.b+e,this.a)},darken(e){return this.lighten(-e)},invert(){return R(1-this.r,1-this.g,1-this.b,this.a)},isDark(e=.5){return this.r+this.g+this.b<3*e},isLight(e=.5){return this.r+this.g+this.b>3*e},eq(e){return this.r===e.r&&this.g===e.g&&this.b===e.g&&this.a===e.a}}}function A(e,t,s,o){return{x:e,y:t,w:s,h:o,clone(){return A(this.x,this.y,this.w,this.h)},eq(e){return this.x===e.x&&this.y===e.y&&this.w===e.w&&this.h===e.h}}}function D(e){return{m:e?[...e]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],clone(){return D(this.m)},mult(e){let t=[];for(let s=0;s<4;s++)for(let o=0;o<4;o++)t[4*s+o]=this.m[0+o]*e.m[4*s+0]+this.m[4+o]*e.m[4*s+1]+this.m[8+o]*e.m[4*s+2]+this.m[12+o]*e.m[4*s+3];return D(t)},multVec4(e){return{x:e.x*this.m[0]+e.y*this.m[4]+e.z*this.m[8]+e.w*this.m[12],y:e.x*this.m[1]+e.y*this.m[5]+e.z*this.m[9]+e.w*this.m[13],z:e.x*this.m[2]+e.y*this.m[6]+e.z*this.m[10]+e.w*this.m[14],w:e.x*this.m[3]+e.y*this.m[7]+e.z*this.m[11]+e.w*this.m[15]}},multVec3(e){let t=this.multVec4({x:e.x,y:e.y,z:e.z,w:1});return w(t.x,t.y,t.z)},multVec2(e){return g(e.x*this.m[0]+e.y*this.m[4]+0*this.m[8]+1*this.m[12],e.x*this.m[1]+e.y*this.m[5]+0*this.m[9]+1*this.m[13])},translate(e){return this.mult(D([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,0,1]))},scale(e){return this.mult(D([e.x,0,0,0,0,e.y,0,0,0,0,1,0,0,0,0,1]))},rotateX(e){return this.mult(D([1,0,0,0,0,Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1]))},rotateY(e){return this.mult(D([Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1]))},rotateZ(e){return this.mult(D([Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1,0,0,0,0,1]))},invert(){let e=[],t=this.m[10]*this.m[15]-this.m[14]*this.m[11],s=this.m[9]*this.m[15]-this.m[13]*this.m[11],o=this.m[9]*this.m[14]-this.m[13]*this.m[10],r=this.m[8]*this.m[15]-this.m[12]*this.m[11],n=this.m[8]*this.m[14]-this.m[12]*this.m[10],i=this.m[8]*this.m[13]-this.m[12]*this.m[9],a=this.m[6]*this.m[15]-this.m[14]*this.m[7],l=this.m[5]*this.m[15]-this.m[13]*this.m[7],u=this.m[5]*this.m[14]-this.m[13]*this.m[6],c=this.m[4]*this.m[15]-this.m[12]*this.m[7],h=this.m[4]*this.m[14]-this.m[12]*this.m[6],d=this.m[5]*this.m[15]-this.m[13]*this.m[7],p=this.m[4]*this.m[13]-this.m[12]*this.m[5],m=this.m[6]*this.m[11]-this.m[10]*this.m[7],f=this.m[5]*this.m[11]-this.m[9]*this.m[7],y=this.m[5]*this.m[10]-this.m[9]*this.m[6],g=this.m[4]*this.m[11]-this.m[8]*this.m[7],v=this.m[4]*this.m[10]-this.m[8]*this.m[6],w=this.m[4]*this.m[9]-this.m[8]*this.m[5];e[0]=this.m[5]*t-this.m[6]*s+this.m[7]*o,e[4]=-(this.m[4]*t-this.m[6]*r+this.m[7]*n),e[8]=this.m[4]*s-this.m[5]*r+this.m[7]*i,e[12]=-(this.m[4]*o-this.m[5]*n+this.m[6]*i),e[1]=-(this.m[1]*t-this.m[2]*s+this.m[3]*o),e[5]=this.m[0]*t-this.m[2]*r+this.m[3]*n,e[9]=-(this.m[0]*s-this.m[1]*r+this.m[3]*i),e[13]=this.m[0]*o-this.m[1]*n+this.m[2]*i,e[2]=this.m[1]*a-this.m[2]*l+this.m[3]*u,e[6]=-(this.m[0]*a-this.m[2]*c+this.m[3]*h),e[10]=this.m[0]*d-this.m[1]*c+this.m[3]*p,e[14]=-(this.m[0]*u-this.m[1]*h+this.m[2]*p),e[3]=-(this.m[1]*m-this.m[2]*f+this.m[3]*y),e[7]=this.m[0]*m-this.m[2]*g+this.m[3]*v,e[11]=-(this.m[0]*f-this.m[1]*g+this.m[3]*w),e[15]=this.m[0]*y-this.m[1]*v+this.m[2]*w;let x=this.m[0]*e[0]+this.m[1]*e[4]+this.m[2]*e[8]+this.m[3]*e[12];for(let t=0;t<4;t++)for(let s=0;s<4;s++)e[4*t+s]*=1/x;return D(e)}}}function E(e,t,s){return e+(Math.sin(s)+1)/2*(t-e)}function T(e){return{seed:e,gen(...e){if(0===e.length)return this.seed=(q*this.seed+N)%Y,this.seed/Y;if(1===e.length){if("number"==typeof e[0])return this.gen(0,e[0]);if(x(e[0]))return this.gen(g(0,0),e[0]);if(k(e[0]))return this.gen(R(0,0,0,0),e[0])}else if(2===e.length){if("number"==typeof e[0]&&"number"==typeof e[1])return this.gen()*(e[1]-e[0])+e[0];if(x(e[0])&&x(e[1]))return g(this.gen(e[0].x,e[1].x),this.gen(e[0].y,e[1].y));if(k(e[0])&&k(e[1]))return R(this.gen(e[0].r,e[1].r),this.gen(e[0].g,e[1].g),this.gen(e[0].b,e[1].b),this.gen(e[0].a,e[1].a))}}}}function _(e){H.seed=e}function F(...e){return H.gen(...e)}function B(e){return F()<=e}function I(e){return e[Math.floor(F(e.length))]}function M(e,t){return e.p2.x>=t.p1.x&&e.p1.x<=t.p2.x&&e.p2.y>=t.p1.y&&e.p1.y<=t.p2.y}function L(e,t){return e.p2.x>t.p1.x&&e.p1.x<t.p2.x&&e.p2.y>t.p1.y&&e.p1.y<t.p2.y}function C(e,t){return t.x>=e.p1.x&&t.x<=e.p2.x&&t.y>=e.p1.y&&t.y<e.p2.y}var q,N,Y,H,O=c((()=>{u(h,"deg2rad"),u(d,"rad2deg"),u(p,"clamp"),u(m,"lerp"),u(f,"map"),u(y,"mapc"),u(g,"vec2"),u(v,"vec2FromAngle"),u(w,"vec3"),u(x,"isVec2"),u(b,"isVec3"),u(k,"isColor"),u(S,"isMat4"),u(P,"rgb"),u(R,"rgba"),u(A,"quad"),u(D,"mat4"),u(E,"wave"),q=1103515245,N=12345,Y=2147483648,H=T(Date.now()),u(T,"makeRng"),u(_,"randSeed"),u(F,"rand"),u(B,"chance"),u(I,"choose"),u(M,"colRectRect"),u(L,"overlapRectRect"),u(C,"colRectPt")}));function U(e,t){let s=typeof e,o=typeof t;if(s!==o)return!1;if("object"===s&&"object"===o){let s=Object.keys(e),o=Object.keys(t);if(s.length!==o.length)return!1;for(let o of s){let s=e[o],r=t[o];if(("function"!=typeof s||"function"!=typeof r)&&!U(s,r))return!1}return!0}return e===t}var W=c((()=>{u(U,"deepEq")}));function j(e){switch(e){case"topleft":return g(-1,-1);case"top":return g(0,-1);case"topright":return g(1,-1);case"left":return g(-1,0);case"center":return g(0,0);case"right":return g(1,0);case"botleft":return g(-1,1);case"bot":return g(0,1);case"botright":return g(1,1);default:return e}}function z(e,t){let s=(()=>{switch(t.texFilter){case"linear":return e.LINEAR;case"nearest":default:return e.NEAREST}})(),o=(()=>{var s;let o=i(Q,Z),r=n(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),a=null!=(s=t.clearColor)?s:R(0,0,0,1);e.clearColor(a.r,a.g,a.b,a.a),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);let l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,4*J,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);let u=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.bufferData(e.ELEMENT_ARRAY_BUFFER,2*J,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);let c=n(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2));return{drawCalls:0,lastDrawCalls:0,defProg:o,curProg:o,defTex:r,curTex:r,curUniform:{},vbuf:l,ibuf:u,vqueue:[],iqueue:[],transform:D(),transformStack:[],clearColor:a,bgTex:c}})();function r(e){return Math.log(e)/Math.log(2)%1==0}function n(t){let o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,s);let n=r(t.width)&&r(t.height)?e.REPEAT:e.CLAMP_TO_EDGE;return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n),e.bindTexture(e.TEXTURE_2D,null),{width:t.width,height:t.height,bind(){e.bindTexture(e.TEXTURE_2D,o)},unbind(){e.bindTexture(e.TEXTURE_2D,null)}}}function i(t=Q,s=Z){let o,r=V.replace("{{user}}",null!=t?t:Q),n=K.replace("{{user}}",null!=s?s:Z),i=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,r),e.shaderSource(a,n),e.compileShader(i),e.compileShader(a),o=e.getShaderInfoLog(i))throw new Error(o);if(o=e.getShaderInfoLog(a))throw new Error(o);let l=e.createProgram();if(e.attachShader(l,i),e.attachShader(l,a),e.bindAttribLocation(l,0,"a_pos"),e.bindAttribLocation(l,1,"a_uv"),e.bindAttribLocation(l,2,"a_color"),e.linkProgram(l),(o=e.getProgramInfoLog(l))&&"\n"!==o)throw new Error(o);return{bind(){e.useProgram(l)},unbind(){e.useProgram(null)},bindAttribs(){e.vertexAttribPointer(0,3,e.FLOAT,!1,4*$,0),e.enableVertexAttribArray(0),e.vertexAttribPointer(1,2,e.FLOAT,!1,4*$,12),e.enableVertexAttribArray(1),e.vertexAttribPointer(2,4,e.FLOAT,!1,4*$,20),e.enableVertexAttribArray(2)},send(t){this.bind();for(let s in t){let o=t[s],r=e.getUniformLocation(l,s);"number"==typeof o?e.uniform1f(r,o):S(o)?e.uniformMatrix4fv(r,!1,new Float32Array(o.m)):k(o)?e.uniform4f(r,o.r,o.g,o.b,o.a):b(o)?e.uniform3f(r,o.x,o.y,o.z):x(o)&&e.uniform2f(r,o.x,o.y)}this.unbind()}}}function c(e,t,s,o){let r=e.width/t,n=1/r,i=1/(e.height/s),a={},l=o.split("").entries();for(let[e,t]of l)a[t]=g(e%r*n,Math.floor(e/r)*i);return{tex:e,map:a,qw:n,qh:i}}function h(e,t,s=o.defTex,r=o.defProg,n={}){s=null!=s?s:o.defTex,r=null!=r?r:o.defProg,(s!==o.curTex||r!==o.curProg||!U(o.curUniform,n)||o.vqueue.length+e.length*$>J||o.iqueue.length+t.length>J)&&d(),o.curTex=s,o.curProg=r,o.curUniform=n;let i=t.map((e=>e+o.vqueue.length/$)),a=e.map((e=>{let t=y(o.transform.multVec2(e.pos.xy()));return[t.x,t.y,e.pos.z,e.uv.x,e.uv.y,e.color.r,e.color.g,e.color.b,e.color.a]})).flat();i.forEach((e=>o.iqueue.push(e))),a.forEach((e=>o.vqueue.push(e)))}function d(){!o.curTex||!o.curProg||0===o.vqueue.length||0===o.iqueue.length||(o.curProg.send(o.curUniform),e.bindBuffer(e.ARRAY_BUFFER,o.vbuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(o.vqueue)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o.ibuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(o.iqueue)),o.curProg.bind(),o.curProg.bindAttribs(),o.curTex.bind(),e.drawElements(e.TRIANGLES,o.iqueue.length,e.UNSIGNED_SHORT,0),o.curTex.unbind(),o.curProg.unbind(),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),o.iqueue=[],o.vqueue=[],o.drawCalls++)}function p(){e.clear(e.COLOR_BUFFER_BIT),t.clearColor||B({width:H(),height:O(),quad:A(0,0,H()*W()/G,O()*W()/G),tex:o.bgTex}),o.drawCalls=0,o.transformStack=[],o.transform=D()}function m(){d(),o.lastDrawCalls=o.drawCalls}function f(){return o.lastDrawCalls}function y(e){return g(e.x/H()*2-1,-e.y/O()*2+1)}function v(e){o.transform=e.clone()}function P(e){!e||0===e.x&&0===e.y||(o.transform=o.transform.translate(e))}function E(e){!e||1===e.x&&1===e.y||(o.transform=o.transform.scale(e))}function T(e){!e||(o.transform=o.transform.rotateZ(e))}function _(){o.transformStack.push(o.transform.clone())}function F(){o.transformStack.length>0&&(o.transform=o.transformStack.pop())}function B(e={}){var t,s;let o=e.width||0,r=e.height||0,n=e.pos||g(0,0),i=j(e.origin||X).dot(g(o,r).scale(-.5)),a=g(null!=(t=e.scale)?t:1),l=e.rot||0,u=e.quad||A(0,0,1,1),c=1-(null!=(s=e.z)?s:0),d=e.color||R(1,1,1,1);_(),P(n),E(a),T(l),P(i),h([{pos:w(-o/2,r/2,c),uv:g(u.x,u.y+u.h),color:d},{pos:w(-o/2,-r/2,c),uv:g(u.x,u.y),color:d},{pos:w(o/2,-r/2,c),uv:g(u.x+u.w,u.y),color:d},{pos:w(o/2,r/2,c),uv:g(u.x+u.w,u.y+u.h),color:d}],[0,1,3,1,2,3],e.tex,e.prog,e.uniform),F()}function I(e,t={}){var s;let o=null!=(s=t.quad)?s:A(0,0,1,1),r=e.width*o.w,n=e.height*o.h;B(l(a({},t),{tex:e,quad:o,width:r,height:n}))}function M(e,t,s,o={}){B(l(a({},o),{pos:e,width:t,height:s}))}function L(e,t,s,o={}){let r=j(o.origin||X).dot(g(t,s)).scale(.5),n=e.add(g(-t/2,-s/2)).sub(r),i=e.add(g(-t/2,s/2)).sub(r),a=e.add(g(t/2,s/2)).sub(r),l=e.add(g(t/2,-s/2)).sub(r);C(n,i,o),C(i,a,o),C(a,l,o),C(l,n,o)}function C(e,t,s={}){let o=s.width||1,r=e.dist(t),n=Math.PI/2-e.angle(t);B(l(a({},s),{pos:e.add(t).scale(.5),width:o,height:r,rot:n,origin:"center"}))}function q(e,t,s={}){let o=(e+"").split(""),r=t.qw*t.tex.width,n=t.qh*t.tex.height,i=g((s.size||n)/n).dot(g(s.scale||1)),a=i.x*r,l=i.y*n,u=0,c=l,h=0,d=[[]];for(let e of o)("\n"===e||!!s.width&&u+a>s.width)&&(c+=l,u=0,d.push([])),"\n"!==e&&(d[d.length-1].push(e),u+=a),h=Math.max(h,u);s.width&&(h=s.width);let p=[],m=g(s.pos||0),f=j(s.origin||X).scale(.5),y=-f.x*a-(f.x+.5)*(h-a),v=-f.y*l-(f.y+.5)*(c-l);return d.forEach(((e,o)=>{let r=(h-e.length*a)*(f.x+.5);e.forEach(((e,n)=>{let u=t.map[e],c=n*a,h=o*l;u&&p.push({tex:t.tex,quad:A(u.x,u.y,t.qw,t.qh),ch:e,pos:g(m.x+c+y+r,m.y+h+v),color:s.color,origin:s.origin,scale:i,z:s.z})}))})),{width:h,height:c,chars:p}}function N(e,t,s={}){Y(q(e,t,s))}function Y(e){for(let t of e.chars)B({tex:t.tex,width:t.tex.width*t.quad.w,height:t.tex.height*t.quad.h,pos:t.pos,scale:t.scale,color:t.color,quad:t.quad,origin:"center",z:t.z})}function H(){return e.drawingBufferWidth/W()}function O(){return e.drawingBufferHeight/W()}function W(){var e;return null!=(e=t.scale)?e:1}function z(){return o.clearColor.clone()}return p(),m(),u(r,"powerOfTwo"),u(n,"makeTex"),u(i,"makeProgram"),u(c,"makeFont"),u(h,"drawRaw"),u(d,"flush"),u(p,"frameStart"),u(m,"frameEnd"),u(f,"drawCalls"),u(y,"toNDC"),u(v,"pushMatrix"),u(P,"pushTranslate"),u(E,"pushScale"),u((function(e){!e||(o.transform=o.transform.rotateX(e))}),"pushRotateX"),u((function(e){!e||(o.transform=o.transform.rotateY(e))}),"pushRotateY"),u(T,"pushRotateZ"),u(_,"pushTransform"),u(F,"popTransform"),u(B,"drawQuad"),u(I,"drawTexture"),u(M,"drawRect"),u(L,"drawRectStroke"),u(C,"drawLine"),u(q,"fmtText"),u(N,"drawText"),u(Y,"drawFmtText"),u(H,"width"),u(O,"height"),u(W,"scale"),u(z,"clearColor"),{width:H,height:O,scale:W,makeTex:n,makeProgram:i,makeFont:c,drawTexture:I,drawText:N,drawFmtText:Y,drawRect:M,drawRectStroke:L,drawLine:C,fmtText:q,frameStart:p,frameEnd:m,pushTransform:_,popTransform:F,pushMatrix:v,drawCalls:f,clearColor:z}}var X,$,J,G,V,K,Q,Z,ee=c((()=>{O(),W(),X="topleft",$=9,J=65536,G=64,V="\nattribute vec3 a_pos;\nattribute vec2 a_uv;\nattribute vec4 a_color;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nvec4 def_vert() {\n\treturn vec4(a_pos, 1.0);\n}\n\n{{user}}\n\nvoid main() {\n\tvec4 pos = vert(a_pos, a_uv, a_color);\n\tv_pos = a_pos;\n\tv_uv = a_uv;\n\tv_color = a_color;\n\tgl_Position = pos;\n}\n",K="\nprecision mediump float;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nuniform sampler2D u_tex;\n\nvec4 def_frag() {\n\treturn v_color * texture2D(u_tex, v_uv);\n}\n\n{{user}}\n\nvoid main() {\n\tgl_FragColor = frag(v_pos, v_uv, v_color, u_tex);\n\tif (gl_FragColor.a == 0.0) {\n\t\tdiscard;\n\t}\n}\n",Q="\nvec4 vert(vec3 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n",Z="\nvec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n",u(j,"originPt"),u(z,"gfxInit")}));function te(e){return"pressed"===e||"rpressed"===e?"down":"released"===e?"up":e}function se(e={}){var t,s;let o={canvas:null!=(t=e.canvas)?t:(()=>{var t;let s=document.createElement("canvas");return(null!=(t=e.root)?t:document.body).appendChild(s),s})(),keyStates:{},charInputted:[],mouseState:"up",mousePos:g(0,0),time:0,realTime:0,skipTime:!1,dt:0,scale:null!=(s=e.scale)?s:1,isTouch:!1,loopID:null,stopped:!1,fps:0,fpsBuf:[],fpsTimer:0},r={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},n=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11"];e.fullscreen?(o.canvas.width=window.innerWidth,o.canvas.height=window.innerHeight):(o.canvas.width=(e.width||640)*o.scale,o.canvas.height=(e.height||480)*o.scale);let i=["outline: none","cursor: default"];e.crisp&&(i.push("image-rendering: pixelated"),i.push("image-rendering: crisp-edges")),o.canvas.style=i.join(";"),o.canvas.setAttribute("tabindex","0");let a=o.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});function l(){return o.mousePos.clone()}function c(){return"pressed"===o.mouseState}function h(){return"pressed"===o.mouseState||"down"===o.mouseState}function d(){return"released"===o.mouseState}function p(e){return"pressed"===o.keyStates[e]}function m(e){return"pressed"===o.keyStates[e]||"rpressed"===o.keyStates[e]}function f(e){return"pressed"===o.keyStates[e]||"rpressed"===o.keyStates[e]||"down"===o.keyStates[e]}function y(e){return"released"===o.keyStates[e]}function v(){return[...o.charInputted]}function w(){return o.dt}function x(){return o.time}function b(){return o.fps}function k(){return o.canvas.toDataURL()}function S(e){return e&&(o.canvas.style.cursor=null!=e?e:"default"),o.canvas.style.cursor}function P(e){let t=u((s=>{let r=s/1e3,n=r-o.realTime;o.realTime=r,o.skipTime||(o.dt=n,o.time+=o.dt,o.fpsBuf.push(1/o.dt),o.fpsTimer+=o.dt,o.fpsTimer>=1&&(o.fpsTimer=0,o.fps=Math.round(o.fpsBuf.reduce(((e,t)=>e+t))/o.fpsBuf.length),o.fpsBuf=[])),o.skipTime=!1,e();for(let e in o.keyStates)o.keyStates[e]=te(o.keyStates[e]);o.mouseState=te(o.mouseState),o.charInputted=[],o.stopped||(o.loopID=requestAnimationFrame(t))}),"frame");o.loopID=requestAnimationFrame(t)}function R(){cancelAnimationFrame(o.loopID),o.stopped=!0}return o.isTouch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,o.canvas.addEventListener("mousemove",(e=>{o.mousePos=g(e.offsetX,e.offsetY).scale(1/o.scale)})),o.canvas.addEventListener("mousedown",(()=>{o.mouseState="pressed"})),o.canvas.addEventListener("mouseup",(()=>{o.mouseState="released"})),o.canvas.addEventListener("touchstart",(e=>{let t=e.touches[0];o.mousePos=g(t.clientX,t.clientY).scale(1/o.scale),o.mouseState="pressed"})),o.canvas.addEventListener("touchmove",(e=>{let t=e.touches[0];o.mousePos=g(t.clientX,t.clientY).scale(1/o.scale)})),o.canvas.addEventListener("keydown",(e=>{let t=r[e.key]||e.key.toLowerCase();n.includes(t)&&e.preventDefault(),1===t.length&&o.charInputted.push(t),"space"===t&&o.charInputted.push(" "),e.repeat?o.keyStates[t]="rpressed":o.keyStates[t]="pressed"})),o.canvas.addEventListener("keyup",(e=>{let t=r[e.key]||e.key.toLowerCase();o.keyStates[t]="released"})),o.canvas.focus(),document.addEventListener("visibilitychange",(()=>{switch(document.visibilityState){case"visible":o.skipTime=!0}})),u(l,"mousePos"),u(c,"mouseClicked"),u(h,"mouseDown"),u(d,"mouseReleased"),u(p,"keyPressed"),u(m,"keyPressedRep"),u(f,"keyDown"),u(y,"keyReleased"),u(v,"charInputted"),u(w,"dt"),u(x,"time"),u(b,"fps"),u(k,"screenshot"),u(S,"cursor"),u(P,"run"),u(R,"quit"),{gl:a,mousePos:l,keyDown:f,keyPressed:p,keyPressedRep:m,keyReleased:y,mouseDown:h,mouseClicked:c,mouseReleased:d,charInputted:v,cursor:S,dt:w,time:x,fps:b,screenshot:k,run:P,quit:R}}var oe=c((()=>{O(),u(te,"processBtnState"),u(se,"appInit")}));function re(){let e=(()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain(),s=t;return s.connect(e.destination),{ctx:e,gainNode:t,masterNode:s}})();function t(t){return void 0!==t&&(e.gainNode.gain.value=p(t,ne,ie)),e.gainNode.gain.value}function s(t,s={loop:!1,volume:1,speed:1,detune:0,seek:0}){var o;let r=!1,n=e.ctx.createBufferSource();n.buffer=t,n.loop=!!s.loop;let i=e.ctx.createGain();n.connect(i),i.connect(e.masterNode);let a=null!=(o=s.seek)?o:0;n.start(0,a);let l=e.ctx.currentTime-a,u=null,c={stop(){r||(this.pause(),l=e.ctx.currentTime)},play(t){if(!r)return;let s=n;n=e.ctx.createBufferSource(),n.buffer=s.buffer,n.loop=s.loop,n.playbackRate.value=s.playbackRate.value,n.detune&&(n.detune.value=s.detune.value),n.connect(i);let o=null!=t?t:this.time();n.start(0,o),l=e.ctx.currentTime-o,r=!1,u=null},pause(){r||(n.stop(),r=!0,u=e.ctx.currentTime)},paused:()=>r,stopped:()=>r,speed:e=>(void 0!==e&&(n.playbackRate.value=p(e,ae,le)),n.playbackRate.value),detune:e=>n.detune?(void 0!==e&&(n.detune.value=p(e,ue,ce)),n.detune.value):0,volume:e=>(void 0!==e&&(i.gain.value=p(e,ne,ie)),i.gain.value),loop(){n.loop=!0},unloop(){n.loop=!1},duration:()=>t.duration,time:()=>r?u-l:e.ctx.currentTime-l};return c.speed(s.speed),c.detune(s.detune),c.volume(s.volume),c}function o(){return e.ctx}return u(t,"volume"),u(s,"play"),u(o,"ctx"),{ctx:o,volume:t,play:s}}var ne,ie,ae,le,ue,ce,he,de=c((()=>{O(),ne=0,ie=3,ae=0,le=3,ue=-1200,ce=1200,u(re,"audioInit")})),pe=c((()=>{he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAvgAAAAICAYAAACML4vTAAAAAXNSR0IArs4c6QAABo1JREFUeJzdW9uO5SgMJKv9/1/OPnQnDabKVQb6zGgtjeYkvmJsYwh9tQLc931//7yu63retdba+/4hTZ6ZDMQ3wHVdPe1kXk/60He2D/J7HLMhGyOwHQKji/o/BYmv40DecRq+cfgr8l8dhBfRLPF3v6F9Cu/ObwFPYxRBFptE7mA/wQ2yWMwI/1r+y3Bq/h4H3TwJ3fl16xcz4UfQPB+oplF9QJ7id+SjMVjz/wf5e5rK+hKfB9+a86PsZTIm+7P6942jufsqSvg7/END5WSg6ojLt7uurcjL6v8pfQ4doinIL9v+f4HTMfQ3gopR5gOQ+6jviPj7EfLvqQGsQFiXb/B7KMBGc/rQ3x1ONuHmBmOQfd93XwDVguPI/3Uw/fc8Dz5s4/xMogU/xScNKILJb4W5Q/YyXtt+IWcyF+GzMajY7ehZbCK5vf2sGczmJ+J6O6J8pT8dB5HPwPU706/knsjfVRlxvhje0Zn5H+F/m/+kf6uA1oxqPVD1Jeqj+kHuRr5x0ZzzU8nJANrCalDS5A54xV9Ynyd+p/6bNXSiBfY5Dk1pkPyObzI0s10ceFr+3+FXsMq/qk+BM97TusU6bIvp+Flf1ufuy/OJBh817s/vlcKOaOHgRBOeyu0nppt4uIEA+gcboLLv96oIu18IFLhfSRooMh19hsvkKyNjkCo6R+fXC3ya/ddAdjrekxH2i8VmiH23oGTNYy+n2iBHyPhYjtWV8IJtyz38BW6a42JMKuJtn30IfgJT+PdkziayaP1W+OpX6J6HyJ+ac8MXaJEvNfnGGheVow34neAn/tag30aByRfI5PDBlZ9tzNghHuJDMnZpGO37rMam/L/Jj2w6wY/8TH1gPCNfQ3zxAJTZ3wPKkS9EIS9bm3OfbDonof9YWgw7gCJ0uqF+390/JIs1QZE+yhjkKOcifMKDdMX3kYbxKB3xn8fsNZEPPm2SBQ7KD/OkkgXZfYV/PV/U/+rok0IswDH+HDyCmAcuXs1LHP8gBzTyd487dIrgAPPfC489wK6K/GwjouYoo6nmZQXUHCtA9RThd+yX87fIn9X3T8Kkl2yC3zlS+NZK9XUClruFjU3093IcBFui8U79Zfg74Flj7dRHJJ/1Hq58xAs3JAdgNb9QDxHB9f8JfgSV+c96QaVnCcRhzx3+r+hXY9qtq1HmKy+up3Ft3T7BN06gWVDGZhI5JL4b6Mh9yolu5T6iukMN7M4KQqWZ/SKYP9+lYJyAOYtPveMy5IPdZja//XPVnkw+tBHdPe35w8kWs3UX+tjNrtggvpWvM3H8Lihi5f/dE1kVD068PL7O+Fc2z65eNseuDEfHKoxFpx4fjm9bS+LjFyEu4F8P4gras1geqq8QzK9wlJ3IWYJk3TtS8zbvV8MN2qGvaxQOXt3YafKe2NjN8U8A2hzGDQpdg37xqzurObB3dOY9uyYG8nG37pXjp9rg7wQm+v0A201GvGqUd4KfFlejgUobxCDjixAXod3NiWVfRaa6YsT0hitIWWAqXyr+JdhYBDJbSg32Y8fOFZvVDdziBq/cABPY8WEKpxf31fgnMM2xq681u9HYagAM/6mxDmM0eXaBNhCELgKt36Z+Vf9GYoDLrsg496TZ8yFg629dEL+D7sDq4FB8bIF7xTaxI2X8Q9dJWf7Y/ks2iPYGf2HsWf5HnOovUH2m4896Q9JDDs+rV7TduKs2+EcLNdnhvM/f+MqCEp8tO437h9C2YEP2nL7/5WR2G79sgYwGqo1ElJHu4F9msAkC84Lscxd4Bg5/ansGhVOAKf7MAuBu4NC8seJ1mQ0lku/okM090M/iS8HuAq/ivxJ/To1RMrDg/G8OTuVHub4e1j/wg9xBuF5fbPJVTlTsdOaPrmdiHVqK3UN/w+Xmz2r+K/mQf6G5RnauwDuHm80oGwCLkZMbHLYB/nkYm9Md/yF6NDa3SR9sNPM/0rD+cpgf8ws+qifOGN35XK2bHznBj3xWEKHTy+QT5HYiGJ83kW3lP5ZI4MTmKU1a9rcFbNyFT76OzVC+olP2tQYLEJNfGmO2iVs4AU/nd/PzejrHiM58z/BWvjnzs+J7QEvxzlcQgFupJxXfVuSjuFP11NFp4bI76IVnpZ/a7cxfRkNiIxtL9n41f1yayhrngmrG5LwYdWkp/x35h9Yg1WC6vlYNuStvKeZW+h9zfR/eIboHxD12Bml87PYgiCZZP5Z81fI5lrm5k0fxfWVj+x9lSgjp7YOOoAAAAABJRU5ErkJggg=="}));function me(e){let t=new Image;return t.src=e,t.crossOrigin="anonymous",new Promise(((s,o)=>{t.onload=()=>{s(t)},t.onerror=()=>{o(`failed to load ${e}`)}}))}function fe(e){return e.startsWith("data:")}function ye(e,t,s={}){let o={lastLoaderID:0,loadRoot:"",loaders:{},sprites:{},sounds:{},fonts:{},shaders:{}};function r(e){var t;let r=o.lastLoaderID;o.loaders[r]=!1,o.lastLoaderID++,e.catch(null!=(t=s.errHandler)?t:console.error).finally((()=>{o.loaders[r]=!0}))}function n(){let e=0,t=0;for(let s in o.loaders)e+=1,o.loaders[s]&&(t+=1);return t/e}function i(e){return e&&(o.loadRoot=e),o.loadRoot}function a(t,s,n,i,a=ge){let l=new Promise(((r,l)=>{me(fe(s)?s:o.loadRoot+s).then((s=>{let l=e.makeFont(e.makeTex(s),n,i,a);o.fonts[t]=l,r(l)})).catch(l)}));return r(l),l}function l(t,s,n={sliceX:1,sliceY:1,anims:{}}){function i(t,s,r={sliceX:1,sliceY:1,gridWidth:0,gridHeight:0,anims:{}}){let n=[],i=e.makeTex(s),a=r.sliceX||i.width/(r.gridWidth||i.width),l=r.sliceY||i.height/(r.gridHeight||i.height),u=1/a,c=1/l;for(let e=0;e<l;e++)for(let t=0;t<a;t++)n.push(A(t*u,e*c,u,c));let h={tex:i,frames:n,anims:r.anims||{}};return o.sprites[t]=h,h}u(i,"loadRawSprite");let a=new Promise(((e,r)=>{if(!s)return r(`expected sprite src for "${t}"`);"string"==typeof s?me(fe(s)?s:o.loadRoot+s).then((s=>{e(i(t,s,n))})).catch(r):e(i(t,s,n))}));return r(a),a}function c(t,s,n,i=!1){function a(t,s,r){let n=e.makeProgram(s,r);return o.shaders[t]=n,n}u(a,"loadRawShader");let l=new Promise(((e,r)=>{if(!s&&!n)return r("no shader");function l(e){return e?fetch(o.loadRoot+e).then((t=>{if(t.ok)return t.text();throw new Error(`failed to load ${e}`)})).catch(r):new Promise((e=>e(null)))}if(u(l,"resolveUrl"),i)Promise.all([l(s),l(n)]).then((([s,o])=>{e(a(t,s,o))})).catch(r);else try{e(a(t,s,n))}catch(e){r(e)}}));return r(l),l}function h(e,s){let n=o.loadRoot+s,i=new Promise(((r,i)=>{if(!s)return i(`expected sound src for "${e}"`);"string"==typeof s&&fetch(n).then((e=>{if(e.ok)return e.arrayBuffer();throw new Error(`failed to load ${n}`)})).then((e=>new Promise(((s,o)=>{t.ctx().decodeAudioData(e,s,o)})))).then((t=>{o.sounds[e]=t,r(t)})).catch(i)}));return r(i),i}function d(){return o.fonts[ve]}return u(r,"addLoader"),u(n,"loadProgress"),u(i,"loadRoot"),u(a,"loadFont"),u(l,"loadSprite"),u(c,"loadShader"),u(h,"loadSound"),u(d,"defFont"),a(ve,he,8,8),{loadRoot:i,loadSprite:l,loadSound:h,loadFont:a,loadShader:c,loadProgress:n,addLoader:r,defFont:d,sprites:o.sprites,fonts:o.fonts,sounds:o.sounds,shaders:o.shaders}}var ge,ve,we=c((()=>{O(),pe(),ge=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",ve="unscii",u(me,"loadImg"),u(fe,"isDataUrl"),u(ye,"assetsInit")}));function xe(e,t,s={max:8}){var o;let r=[],n=null!=(o=s.max)?o:8;function i(){r.length>n&&(r=r.slice(0,n));let s=g(0,e.height());r.forEach(((o,r)=>{let i=f(r,0,n,1,.5),a=f(r,0,n,.8,.2),l=(()=>{switch(o.type){case"info":return R(1,1,1,i);case"error":return R(1,0,.5,i)}})(),u=e.fmtText(o.msg,t.defFont(),{pos:s,origin:"botleft",color:l,size:be/e.scale(),width:e.width()});e.drawRect(s,u.width,u.height,{origin:"botleft",color:R(0,0,0,a)}),e.drawFmtText(u),s.y-=u.height}))}function a(e){console.error(e),r.unshift({type:"error",msg:e})}function l(e){r.unshift({type:"info",msg:e})}function c(){r=[]}return u(i,"draw"),u(a,"error"),u(l,"info"),u(c,"clear"),{info:l,error:a,draw:i,clear:c}}var be,ke=c((()=>{O(),be=16,u(xe,"loggerInit")}));function Se(e){let t={},s=[],o=null;function r(){return null!==o&&1===o.readyState}function n(){let r=new WebSocket(e);return new Promise(((n,i)=>{r.onopen=()=>{n(r),o=r;for(let e of s)r.send(e)},r.onerror=()=>{i(`failed to connect to ${e}`)},r.onmessage=e=>{let s=JSON.parse(e.data);if(t[s.type])for(let e of t[s.type])e(s.data,s.id)}}))}function i(e,s){t[e]||(t[e]=[]),t[e].push(s)}function a(e,t){let r=JSON.stringify({type:e,data:t});o?o.send(r):s.push(r)}function l(){o&&o.close()}return u(r,"connected"),u(n,"connect"),u(i,"recv"),u(a,"send"),u(l,"close"),{connect:n,close:l,connected:r,recv:i,send:a}}var Pe,Re,Ae=c((()=>{u(Se,"netInit")}));const De=(Pe=(e,t)=>{O(),ee(),oe(),de(),we(),ke(),Ae(),t.exports=(e={width:640,height:480,scale:1,fullscreen:!1,debug:!1,crisp:!1,canvas:null,connect:null,logMax:8,root:document.body})=>{let t=se({width:e.width,height:e.height,scale:e.scale,fullscreen:e.fullscreen,crisp:e.crisp,canvas:e.canvas,root:e.root}),s=z(t.gl,{clearColor:e.clearColor?R(e.clearColor):void 0,scale:e.scale,texFilter:e.texFilter}),o=re(),r=ye(s,o,{errHandler:e=>{n.error(e)}}),n=xe(s,r,{max:e.logMax}),i=e.connect?Se(e.connect):null;function c(e,t){if(!i)throw new Error("not connected to any websockets");i.recv(e,((e,s)=>{try{t(e,s)}catch(e){n.error(e)}}))}function w(e,t){if(!i)throw new Error("not connected to any websockets");i.send(e,t)}function x(){return t.dt()*Ke.timeScale}function b(e,t={}){let s=r.sounds[e];if(!s)throw new Error(`sound not found: "${e}"`);return o.play(s,t)}function k(e){var t;let s=O();return!(null==(t=s.layers[null!=e?e:s.defLayer])?void 0:t.noCam)}function S(e){return k(e)?O().cam.mpos:t.mousePos()}function q(e,t={}){var o;let n="string"==typeof e?r.sprites[e]:e;if(!n)throw new Error(`sprite not found: "${e}"`);let i=n.frames[null!=(o=t.frame)?o:0];s.drawTexture(n.tex,l(a({},t),{quad:i}))}function N(e,t={}){var o;let n=null!=(o=t.font)?o:ve,i=r.fonts[n];if(!i)throw new Error(`font not found: ${n}`);s.drawText(e,i,t)}u(c,"recv"),u(w,"send"),u(x,"dt"),u(b,"play"),u(k,"isCamLayer"),u(S,"mousePos"),u(q,"drawSprite"),u(N,"drawText");let Y={loaded:!1,scenes:{},curScene:null,nextScene:null};function H(e,t){Y.scenes[e]={init:t,initialized:!1,events:{add:[],update:[],draw:[],destroy:[],keyDown:[],keyPress:[],keyPressRep:[],keyRelease:[],mouseClick:[],mouseRelease:[],mouseDown:[],charInput:[]},action:[],render:[],objs:new Map,lastObjID:0,timers:{},lastTimerID:0,cam:{pos:g(s.width()/2,s.height()/2),scale:g(1,1),angle:0,shake:0,mpos:g(0),matrix:D()},layers:{},defLayer:null,gravity:980,data:{}}}function O(){return Y.scenes[Y.curScene]}function U(){return O().data}function W(){fe("`",(()=>{Ke.showLog=!Ke.showLog,n.info("show log: "+(Ke.showLog?"on":"off"))})),fe("f1",(()=>{Ke.inspect=!Ke.inspect,n.info("inspect: "+(Ke.inspect?"on":"off"))})),fe("f2",(()=>{Ke.clearLog()})),fe("f8",(()=>{Ke.paused=!Ke.paused,n.info(Ke.paused?"paused":"unpaused")})),fe("f7",(()=>{Ke.timeScale=p(Ke.timeScale-.2,0,2),n.info(`time scale: ${Ke.timeScale.toFixed(1)}`)})),fe("f9",(()=>{Ke.timeScale=p(Ke.timeScale+.2,0,2),n.info(`time scale: ${Ke.timeScale.toFixed(1)}`)})),fe("f10",(()=>{Ke.stepFrame(),n.info("stepped frame")}))}function X(e,...t){Y.nextScene={name:e,args:[...t]}}function $(t,...s){J(t),Y.curScene=t;let o=Y.scenes[t];if(!o)throw new Error(`scene not found: '${t}'`);if(!o.initialized){try{o.init(...s)}catch(e){n.error(e.stack)}e.debug&&W(),o.initialized=!0}}function J(e){if(!Y.scenes[e])throw new Error(`scene not found: '${e}'`);H(e,Y.scenes[e].init)}function G(e,t){let s=O();!s||(e.forEach(((e,t)=>{s.layers[e]={alpha:1,order:t+1,noCam:!1}})),t&&(s.defLayer=t))}function V(...e){let t=O().cam;return e.length>0&&(t.pos=g(...e)),t.pos.clone()}function K(...e){let t=O().cam;return e.length>0&&(t.scale=g(...e)),t.scale.clone()}function Q(e){let t=O().cam;return void 0!==e&&(t.angle=e),t.angle}function Z(e){O().cam.shake=e}function ee(e){let t=O();e.forEach((e=>{t.layers[e]&&(t.layers[e].noCam=!0)}))}function te(e){let t={hidden:!1,paused:!1,_tags:[],_id:null,_events:{add:[],update:[],draw:[],destroy:[],inspect:[]},use(e){if(void 0===e)return;let t=typeof e;if("string"!==t){if("object"!==t)throw new Error(`invalid comp type: ${t}`);if(Array.isArray(e))for(let t of e)this.use(t);else for(let t in e)"function"!=typeof e[t]?this[t]=e[t]:this._events[t]?this._events[t].push(e[t].bind(this)):this[t]=e[t].bind(this)}else this._tags.push(e)},exists(){return void 0!==this._id},is(e){if("*"===e)return!0;if(Array.isArray(e)){for(let t of e)if(!this._tags.includes(t))return!1;return!0}return this._tags.includes(e)},on(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},action(e){this.on("update",e)},trigger(e,...t){if(this._events[e])for(let s of this._events[e])s.call(this,...t);let s=O().events[e];if(s)for(let e of s)this.is(e.tag)&&e.cb(this,...t)},rmTag(e){let t=this._tags.indexOf(e);t>-1&&this._tags.splice(t,1)}};t.use(e);let s=O(),o=s.lastObjID++;s.objs.set(o,t),t._id=o,t.trigger("add");for(let e of s.events.add)t.is(e.tag)&&e.cb(t);return t}function oe(e){if(!e.exists())return;let t=O();t.objs.delete(e._id);let s=t.lastObjID++;return t.objs.set(s,e),e._id=s,e}function ne(e,t,s){let o=O();o.events[e]||(o.events[e]=[]),o.events[e].push({tag:t,cb:s})}function ie(e,t){"function"==typeof e&&void 0===t?O().action.push(e):"string"==typeof e&&ne("update",e,t)}function ae(e,t){"function"==typeof e&&void 0===t?O().render.push(e):"string"==typeof e&&ne("update",e,t)}function le(e,t,s){ie(e,(e=>{e._checkCollisions(t,(t=>{s(e,t)}))}))}function ue(e,t,s){ie(e,(e=>{e._checkOverlaps(t,(t=>{s(e,t)}))}))}function ce(e,t){ie(e,(e=>{e.isClicked()&&t(e)}))}function he(e,t){return new Promise((s=>{let o=O();o.timers[o.lastTimerID++]={time:e,cb:()=>{t&&t(),s()}}}))}function de(e,t){let s=!1,o=u((()=>{s||(t(),he(e,o))}),"newF");return o(),{stop(){s=!0}}}function pe(e,t,s){if(Array.isArray(t))for(let o of t)pe(e,o,s);else O().events[e].push({key:t,cb:s})}function me(e,t){pe("keyDown",e,t)}function fe(e,t){pe("keyPress",e,t)}function ge(e,t){pe("keyPressRep",e,t)}function we(e,t){pe("keyRelease",e,t)}function be(e){O().events.charInput.push({cb:e})}function ke(e){O().events.mouseDown.push({cb:e})}function Pe(e){O().events.mouseClick.push({cb:e})}function Re(e){O().events.mouseRelease.push({cb:e})}function Ae(e){let t=O(),s=[...t.objs.values()].sort(((e,s)=>{var o,r,n,i,a,l;return(null!=(n=null==(r=t.layers[null!=(o=e.layer)?o:t.defLayer])?void 0:r.order)?n:0)-(null!=(l=null==(a=t.layers[null!=(i=s.layer)?i:t.defLayer])?void 0:a.order)?l:0)}));return e?s.filter((t=>t.is(e))):s}function De(e,t){"function"==typeof e&&void 0===t?Ae().forEach(e):"string"==typeof e&&Ae(e).forEach(t)}function Ee(e,t){"function"==typeof e&&void 0===t?Ae().reverse().forEach(e):"string"==typeof e&&Ae(e).reverse().forEach(t)}function Te(e){if(!e.exists())return;let t=O();!t||(e.trigger("destroy"),t.objs.delete(e._id),delete e._id)}function _e(e){De(e,(e=>{Te(e)}))}function Fe(e){let t=O();return void 0!==e&&(t.gravity=e),t.gravity}function Be(e){let o=O();if(!o)throw new Error(`scene not found: '${Y.curScene}'`);let r=e||!Ke.paused;if(r)for(let e in o.timers){let t=o.timers[e];t.time-=x(),t.time<=0&&(t.cb(),delete o.timers[e])}if(Ee((e=>{!e.paused&&r&&e.trigger("update")})),r)for(let e of o.action)e();let n=g(s.width(),s.height()),i=o.cam,a=v(F(0,2*Math.PI)).scale(i.shake);i.shake=m(i.shake,0,5*x()),i.matrix=D().translate(n.scale(.5)).scale(i.scale).rotateZ(i.angle).translate(n.scale(-.5)).translate(i.pos.scale(-1).add(n.scale(.5)).add(a)),i.mpos=i.matrix.invert().multVec2(t.mousePos()),De((e=>{e.hidden||(s.pushTransform(),k(e.layer)&&s.pushMatrix(i.matrix),e.trigger("draw"),s.popTransform())}));for(let e of o.render)e()}function Ie(){let e=O();for(let s of e.events.charInput)t.charInputted().forEach(s.cb);for(let s of e.events.keyDown)t.keyDown(s.key)&&s.cb();for(let s of e.events.keyPress)t.keyPressed(s.key)&&s.cb();for(let s of e.events.keyPressRep)t.keyPressedRep(s.key)&&s.cb();for(let s of e.events.keyRelease)t.keyReleased(s.key)&&s.cb();for(let s of e.events.mouseDown)t.mouseDown()&&s.cb();for(let s of e.events.mouseClick)t.mouseClicked()&&s.cb();for(let s of e.events.mouseRelease)t.mouseReleased()&&s.cb()}function Me(){var o;let n=O(),i=null,a=r.defFont(),l=R(null!=(o=e.inspectColor)?o:[0,1,1,1]);function c(e,t,o){let r=g(4).scale(1/o),n=s.fmtText(t,a,{size:12/o,pos:e.add(g(r.x,r.y))});s.drawRect(e,n.width+2*r.x,n.height+2*r.x,{color:R(0,0,0,1)}),s.drawFmtText(n)}function h(e,t){let o=k(e.layer),r=s.scale()*(o?(n.cam.scale.x+n.cam.scale.y)/2:1);o&&(s.pushTransform(),s.pushMatrix(n.cam.matrix)),t(r),o&&s.popTransform()}u(c,"drawInspectTxt"),u(h,"drawObj"),Ee((e=>{!e.area||e.hidden||h(e,(t=>{i||e.isHovered()&&(i=e);let o=(i===e?6:2)/t,r=e._worldArea(),n=r.p2.x-r.p1.x,a=r.p2.y-r.p1.y;s.drawRectStroke(r.p1,n,a,{width:o,color:l})}))})),i&&h(i,(e=>{let t=S(i.layer),s=[];for(let e of i._tags)s.push(`"${e}"`);for(let e of i._events.inspect){let t=e();for(let e in t)s.push(`${e}: ${t[e]}`)}c(t,s.join("\n"),e)})),c(g(0),t.fps()+"",s.scale())}function Le(e,...o){t.run((()=>{if(s.frameStart(),Y.loaded){try{if(!O())throw new Error(`scene not found: '${Y.curScene}'`);Ie(),Be(),Ke.inspect&&Me()}catch(e){n.error(e.stack),t.quit()}Ke.showLog&&n.draw(),Y.nextScene&&($.apply(null,[Y.nextScene.name,...Y.nextScene.args]),Y.nextScene=null)}else{let t=r.loadProgress();if(1===t)Y.loaded=!0,$(e,...o),i&&i.connect().catch(n.error);else{let e=s.width()/2,o=24/s.scale(),r=g(s.width()/2,s.height()/2).sub(g(e/2,o/2));s.drawRect(g(0),s.width(),s.height(),{color:P(0,0,0)}),s.drawRectStroke(r,e,o,{width:4/s.scale()}),s.drawRect(r,e*t,o)}}s.frameEnd()}))}function Ce(...e){return{pos:g(...e),move(...e){let t=g(...e),s=t.x*x(),o=t.y*x();this.pos.x+=s,this.pos.y+=o},inspect(){return{pos:`(${~~this.pos.x}, ${~~this.pos.y})`}}}}function qe(...e){return 0===e.length?qe(1):{scale:g(...e),flipX(e){this.scale.x=Math.sign(e)*Math.abs(this.scale.x)},flipY(e){this.scale.y=Math.sign(e)*Math.abs(this.scale.y)}}}function Ne(e){return{angle:null!=e?e:0}}function Ye(...e){return{color:R(...e)}}function He(e){return{origin:e}}function Oe(e){return{layer:e,inspect(){var e;let t=O();return{layer:null!=(e=this.layer)?e:t.defLayer}}}}function Ue(e,t){var s,o;let r=O();return(null!=(s=e.layer)?s:r.defLayer)===(null!=(o=t.layer)?o:r.defLayer)}function We(e,s){let o={},r={};return{area:{p1:e,p2:s},areaWidth(){let{p1:e,p2:t}=this._worldArea();return t.x-e.x},areaHeight(){let{p1:e,p2:t}=this._worldArea();return t.y-e.y},isClicked(){return t.mouseClicked()&&this.isHovered()},isHovered(){return this.hasPt(S(this.layer))},isCollided(e){return!(!e.area||!Ue(this,e))&&M(this._worldArea(),e._worldArea())},isOverlapped(e){return!(!e.area||!Ue(this,e))&&L(this._worldArea(),e._worldArea())},clicks(e){this.action((()=>{this.isClicked()&&e()}))},hovers(e){this.action((()=>{this.isHovered()&&e()}))},collides(e,t){this.action((()=>{this._checkCollisions(e,t)}))},overlaps(e,t){this.action((()=>{this._checkOverlaps(e,t)}))},hasPt(e){let t=this._worldArea();return C({p1:t.p1,p2:t.p2},e)},resolve(){let e=[];return De((t=>{if(t===this||!t.solid||!t.area||!Ue(this,t))return;let s=this._worldArea(),o=t._worldArea();if(!M(s,o))return;let r=s.p2.x-o.p1.x,n=o.p2.x-s.p1.x,i=s.p2.y-o.p1.y,a=o.p2.y-s.p1.y,l=Math.min(r,n,i,a),u=(()=>{switch(l){case r:return this.pos.x-=r,"right";case n:return this.pos.x+=n,"left";case i:return this.pos.y-=i,"bottom";case a:return this.pos.y+=a,"top"}})();e.push({obj:t,side:u})})),e},_checkCollisions(e,t){De(e,(e=>{this!==e&&(o[e._id]||this.isCollided(e)&&(t(e),o[e._id]=e))}));for(let e in o){let t=o[e];this.isCollided(t)||delete o[e]}},_checkOverlaps(e,t){De(e,(e=>{this!==e&&(r[e._id]||this.isOverlapped(e)&&(t(e),r[e._id]=e))}));for(let e in r){let t=r[e];this.isOverlapped(t)||delete r[e]}},_worldArea(){let e=this.area,t=this.pos||g(0),s=this.scale||g(1),o=t.add(e.p1.dot(s)),r=t.add(e.p2.dot(s));return{p1:g(Math.min(o.x,r.x),Math.min(o.y,r.y)),p2:g(Math.max(o.x,r.x),Math.max(o.y,r.y))}}}}function je(e,t,s){let o=g(e,t),r=j(s||"topleft").dot(o).scale(-.5);return We(r.sub(o.scale(.5)),r.add(o.scale(.5)))}function ze(e,t={}){let s=r.sprites[e];if(!s)throw new Error(`sprite not found: "${e}"`);let o=a({},s.frames[0]);t.quad&&(o.x+=t.quad.x*o.w,o.y+=t.quad.y*o.h,o.w*=t.quad.w,o.h*=t.quad.h);let n=s.tex.width*o.w,i=s.tex.height*o.h,l=null;return{width:n,height:i,animSpeed:t.animSpeed||.1,frame:t.frame||0,quad:t.quad||A(0,0,1,1),add(){!this.area&&!t.noArea&&this.use(je(this.width,this.height,this.origin))},draw(){O(),s.frames[this.frame],q(s,{pos:this.pos,scale:this.scale,rot:this.angle,color:this.color,frame:this.frame,origin:this.origin,quad:this.quad,prog:r.shaders[this.shader],uniform:this.uniform})},update(){if(!l)return;let e=s.anims[l.name];l.timer+=x(),l.timer>=this.animSpeed&&(this.frame++,this.frame>e.to&&(l.loop?this.frame=e.from:(this.frame--,this.stop())),l&&(l.timer-=this.animSpeed))},play(e,t=!0){let o=s.anims[e];if(!o)throw new Error(`anim not found: ${e}`);l&&this.stop(),l={name:e,loop:t,timer:0},this.frame=o.from,this.trigger("animPlay",e)},stop(){if(!l)return;let e=l.name;l=null,this.trigger("animEnd",e)},changeSprite(e){if(s=r.sprites[e],!s)throw new Error(`sprite not found: "${e}"`);let o=a({},s.frames[0]);t.quad&&(o.x+=t.quad.x*o.w,o.y+=t.quad.y*o.h,o.w*=t.quad.w,o.h*=t.quad.h),this.width=s.tex.width*o.w,this.height=s.tex.height*o.h,this.area&&!t.noArea&&this.use(je(this.width,this.height,this.origin)),l=null,this.frame=0},numFrames:()=>s.frames.length,curAnim:()=>null==l?void 0:l.name,inspect(){let e={};return l&&(e.curAnim=`"${l.name}"`),e}}}function Xe(e,t,o={}){return{text:e,textSize:t,font:o.font,width:0,height:0,add(){var e,t,n;if(!this.area&&!o.noArea){O();let i=r.fonts[null!=(e=this.font)?e:ve],a=s.fmtText(this.text+"",i,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:o.width});this.width=a.width/((null==(t=this.scale)?void 0:t.x)||1),this.height=a.height/((null==(n=this.scale)?void 0:n.y)||1),this.use(je(this.width,this.height,this.origin))}},draw(){var e;O();let t=r.fonts[null!=(e=this.font)?e:ve],n=s.fmtText(this.text+"",t,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:o.width});this.width=n.width,this.height=n.height,s.drawFmtText(n)}}}function $e(e,t,o={}){return{width:e,height:t,add(){!this.area&&!o.noArea&&this.use(je(this.width,this.height,this.origin))},draw(){O(),s.drawRect(this.pos,this.width,this.height,{scale:this.scale,rot:this.angle,color:this.color,origin:this.origin,prog:r.shaders[this.shader],uniform:this.uniform})}}}function Je(){return{solid:!0}}function Ge(e={}){var t,s;let o=0,r=null,n=null,i=null!=(t=e.maxVel)?t:960;return{jumpForce:null!=(s=e.jumpForce)?s:480,update(){this.move(0,o);let e=this.resolve(),t=!1;if(r&&(r.exists()&&this.isCollided(r)?n&&(this.pos=this.pos.add(r.pos.sub(n)),n=r.pos.clone()):(r=null,n=null,t=!0)),!r){o=Math.min(o+Fe()*x(),i);for(let s of e)"bottom"===s.side&&o>0?(r=s.obj,o=0,n=r.pos.clone(),t||this.trigger("grounded",r)):"top"===s.side&&o<0&&(o=0,this.trigger("headbump",s.obj))}},curPlatform:()=>r,grounded:()=>null!==r,falling:()=>o>0,jump(e){r=null,o=-e||-this.jumpForce}}}function Ve(e,t={}){return r.shaders[e],{shader:e,uniform:t}}u(H,"scene"),u(O,"curScene"),u(U,"sceneData"),u(W,"regDebugInputs"),u(X,"go"),u($,"goSync"),u(J,"reload"),u(G,"layers"),u(V,"camPos"),u(K,"camScale"),u(Q,"camRot"),u(Z,"camShake"),u(ee,"camIgnore"),u(te,"add"),u(oe,"readd"),u(ne,"on"),u(ie,"action"),u(ae,"render"),u(le,"collides"),u(ue,"overlaps"),u(ce,"clicks"),u(he,"wait"),u(de,"loop"),u(pe,"pushKeyEvent"),u(me,"keyDown"),u(fe,"keyPress"),u(ge,"keyPressRep"),u(we,"keyRelease"),u(be,"charInput"),u(ke,"mouseDown"),u(Pe,"mouseClick"),u(Re,"mouseRelease"),u(Ae,"get"),u(De,"every"),u(Ee,"revery"),u(Te,"destroy"),u(_e,"destroyAll"),u(Fe,"gravity"),u(Be,"gameFrame"),u(Ie,"handleEvents"),u(Me,"drawInspect"),u(Le,"start"),u(Ce,"pos"),u(qe,"scale"),u(Ne,"rotate"),u(Ye,"color"),u(He,"origin"),u(Oe,"layer"),u(Ue,"isSameLayer"),u(We,"area"),u(je,"getAreaFromSize"),u(ze,"sprite"),u(Xe,"text"),u($e,"rect"),u(Je,"solid"),u(Ge,"body"),u(Ve,"shader");let Ke={paused:!1,inspect:!1,timeScale:1,showLog:!0,fps:t.fps,objCount:()=>O().objs.size,stepFrame(){Be(!0)},drawCalls:s.drawCalls,clearLog:n.clear,log:n.info,error:n.error};function Qe(e,t){let s=[],o=g(t.pos||0),r=0,n={getPos(...e){let s=g(...e);return g(o.x+s.x*t.width,o.y+s.y*t.height)},spawn(e,r){let n=(()=>{if(Array.isArray(e))return e;if(t[e]){if("function"==typeof t[e])return t[e]();if(Array.isArray(t[e]))return[...t[e]]}else if(t.any)return t.any(e)})();if(!n)return;n.push(Ce(o.x+r.x*t.width,o.y+r.y*t.height));let i=te(n);return s.push(i),i.use({gridPos:r.clone(),setGridPos(e){this.gridPos=e.clone(),this.pos=g(o.x+this.gridPos.x*t.width,o.y+this.gridPos.y*t.height)},moveLeft(){this.setGridPos(this.gridPos.add(g(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(g(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(g(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(g(0,1)))}}),i},width:()=>r*t.width,height:()=>e.length*t.height,destroy(){for(let e of s)Te(e)}};return e.forEach(((e,t)=>{let s=e.split("");r=Math.max(s.length,r),s.forEach(((e,s)=>{n.spawn(e,g(s,t))}))})),n}u(Qe,"addLevel");let Ze={start:Le,loadRoot:r.loadRoot,loadSprite:r.loadSprite,loadSound:r.loadSound,loadFont:r.loadFont,loadShader:r.loadShader,addLoader:r.addLoader,width:s.width,height:s.height,dt:x,time:t.time,screenshot:t.screenshot,scene:H,go:X,sceneData:U,layers:G,camPos:V,camScale:K,camRot:Q,camShake:Z,camIgnore:ee,gravity:Fe,add:te,readd:oe,destroy:Te,destroyAll:_e,get:Ae,every:De,revery:Ee,send:w,recv:c,pos:Ce,scale:qe,rotate:Ne,color:Ye,origin:He,layer:Oe,area:We,sprite:ze,text:Xe,rect:$e,solid:Je,body:Ge,shader:Ve,on:ne,action:ie,render:ae,collides:le,overlaps:ue,clicks:ce,keyDown:me,keyPress:fe,keyPressRep:ge,keyRelease:we,charInput:be,mouseDown:ke,mouseClick:Pe,mouseRelease:Re,mousePos:S,cursor:t.cursor,keyIsDown:t.keyDown,keyIsPressed:t.keyPressed,keyIsPressedRep:t.keyPressedRep,keyIsReleased:t.keyReleased,mouseIsDown:t.mouseDown,mouseIsClicked:t.mouseClicked,mouseIsReleased:t.mouseReleased,loop:de,wait:he,play:b,volume:o.volume,makeRng:T,rand:F,randSeed:_,vec2:g,rgb:P,rgba:R,quad:A,choose:I,chance:B,lerp:m,map:f,mapc:y,wave:E,deg2rad:h,rad2deg:d,drawSprite:q,drawText:N,drawRect:s.drawRect,drawRectStroke:s.drawRectStroke,drawLine:s.drawLine,debug:Ke,addLevel:Qe};if(e.plugins)for(let t of e.plugins){let e=t(Ze);for(let t in e)Ze[t]=e[t]}if(e.global)for(let e in Ze)window[e]=Ze[e];return Ze}},()=>(Re||Pe(Re={exports:{}},Re),Re.exports))()({width:800,height:800,scale:1,fullscreen:!1,canvas:document.getElementById("game"),clearColor:[0,0,0,1],debug:!0}),Ee=function(e,t,s,o){return new Promise((function(r,n){r({x:e-s,y:t-o})}))};De.loadSprite("hades","./src/sprites/friendly/circle.png"),De.loadSprite("bullet","./src/sprites/world/bullet.png"),De.loadSprite("bulletRight","./src/sprites/world/bulletRight.png"),De.loadSprite("bulletLeft","./src/sprites/world/bulletLeft.png"),De.loadSprite("bulletUp","./src/sprites/world/bulletUp.png"),De.loadSprite("bulletDown","./src/sprites/world/bulletDown.png"),De.loadSprite("heartIcon","./src/sprites/world/heart.png"),De.loadSprite("star","./src/sprites/world/star.png"),De.loadSprite("boss","./src/sprites/enemy/golemSmall.png"),De.loadSprite("door","./src/sprites/world/door.png"),De.loadSprite("enemy","./src/sprites/enemy/enemy.png"),De.loadSprite("enemy2","./src/sprites/enemy/enemy2.png"),De.loadSprite("enemy3","./src/sprites/enemy/enemy3.png"),De.loadSound("shoot","./src/components/sounds/shoot.wav"),De.loadSprite("wall","./src/sprites/world/wall.png"),De.loadSprite("longWall","./src/sprites/world/longwall.png"),De.loadSprite("vWall","./src/sprites/world/vWall.png"),De.loadSound("hit","./src/components/sounds/hit.wav"),De.loadSound("level1music","./src/components/sounds/level1music.mp3"),De.loadSound("levelTwoMusic","./src/components/sounds/level2.mp3"),De.loadSound("levelTwoMusic","./src/components/sounds/level2.mp3");const Te=function(e,t,s,o){return new Promise((function(r,n){r({x:(e-s)/2.13,y:(t-o)/2.13})}))},_e=function(e,t){return new Promise((function(s,o){var r=e,n=t;let i=Math.floor(3*Math.random()+1);var a=607,l=114,u=607,c=598,h=104,d=545,p=154,m=101;if(r<400&&n<400)switch(i){case 1:Te(u,c,e,t).then((e=>s(e)));break;case 2:Te(a,l,e,t).then((e=>s(e)));break;case 3:Te(h,d,e,t).then((e=>s(e)))}if(r<400&&n>400)switch(i){case 1:Te(u,c,e,t).then((e=>s(e)));break;case 2:Te(a,l,e,t).then((e=>s(e)));break;case 3:Te(p,m,e,t).then((e=>s(e)))}if(r>400&&n<400)switch(i){case 1:Te(u,c,e,t).then((e=>s(e)));break;case 2:Te(p,m,e,t).then((e=>s(e)));break;case 3:Te(h,d,e,t).then((e=>s(e)))}if(r>400&&n>400)switch(i){case 1:Te(p,m,e,t).then((e=>s(e)));break;case 2:Te(a,l,e,t).then((e=>s(e)));break;case 3:Te(h,d,e,t).then((e=>s(e)))}}))};De.loadSound("hurt","./src/components/sounds/explosion.wav"),De.loadSound("firstPhase","./src/components/sounds/firstPhase.mp3"),De.loadSound("secondphase","./src/components/sounds/secondphase.mp3"),De.loadSound("firstPhase","./src/components/sounds/firstPhase.mp3"),De.loadSound("startMenuSound","./src/components/sounds/startMenuMusic.mp3"),De.loadSound("died","./src/components/sounds/died.mp3"),De.loadSound("win","./src/components/sounds/winMusic.mp3"),De.scene("startScreen",(()=>{const{add:e,pos:t,color:s,go:o,play:r,scale:n,text:i,keyPress:a,charInput:l,rgba:u,loop:c,wait:h}=De,d=r("startMenuSound");d.volume(.4),d.play();var p="";a("enter",(()=>{p.length<=0?window.alert("your name fucker!"):(d.pause(),o("level1",p))})),a("backspace",(()=>{p=p.slice(0,-1),m.use(i(`${p}`))})),l((e=>{" "==e&&(e="_"),p.length>=8||(p+=e,m.use(i(`${p}`)))})),e([i(`Enter Your Name${p}`),t(275,400),s(u(1,1,1)),n(2)]);const m=e([i(`${p}`),t(335,430),s(u(1,1,1)),n(2)]),f=(e([i("circle VS square",9),t(256,300),s(u(1,1,1)),n(2)]),e([i("Press Enter To Start",10),t(210,600),s(u(1,1,1)),n(2)]));c(1.5,(()=>{h(1,(()=>{f.use(s(0,0,0))})),f.use(s(u(1,1,1)))}))})),De.scene("level1",(e=>{console.log(e);const{add:t,pos:s,color:o,destroy:r,camShake:n,go:i,play:a,wait:l,scale:u,sprite:c,text:h,vec2:d,rand:p,solid:m,layers:f,layer:y,rgba:g,get:v}=De;let w="up";const x=a("level1music",{volume:.4,detune:-100});x.loop(),x.play();const b=t([c("hades"),s(200,200),u(1),E(20),m(),"hades"]);f(["bg","ui","game"],"game");var k=0,S=b.hp();let P=5;const R=t([h(`${k}`),s(50,60),o(g(1,1,1)),u(2),y("ui"),"score"]),A=(t([c("star"),s(10,50),u(.5),y("ui"),"star"]),t([h(`${S}`),s(50,100),o(g(1,0,0)),u(2),y("ui"),"score"])),D=(t([c("heartIcon"),s(10,90),u(.5),y("ui"),"heart"]),t([h(`Wave :${P}`,8),s(325,50),o(g(1,0,.3)),u(2),y("ui"),"wave"]));function E(t){return{hurt(s){if(t-=s,"hades"==this._tags[0]){var o=document.getElementById("game-container");o.style.backgroundColor="red",De.wait(.2,(()=>{o.style.backgroundColor="black"}))}t<=0&&("hades"==this._tags[0]&&(x.stop(),r(this),i("endScreen",{theScore:k,theHp:t,theName:e,outcome:!1})),r(this))},heal(e){t+=e},hp:()=>t}}function T(){k++,R.use(h(`${k}`))}De.keyPress("s",(()=>{w="down"})),De.keyPress("w",(()=>{w="up"})),De.keyPress("c",(()=>{crashFunction()})),De.keyPress("a",(()=>{w="left"})),De.keyPress("d",(()=>{w="right"})),De.keyDown("s",(()=>{b.move(0,300)})),De.keyDown("w",(()=>{b.move(0,-300)})),De.keyDown("a",(()=>{b.move(-300,0)})),De.keyDown("d",(()=>{b.move(300,0)})),De.keyPress("space",(()=>{var e;a("shoot",{volume:.6,speed:1}),t("left"==(e=w)?[c("bulletLeft"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}]:"right"==e?[c("bulletRight"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}]:"up"==e?[c("bulletUp"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}]:[c("bulletDown"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}])})),De.keyPress("enter",(()=>{x.stop(),_.stop(),i("level2",{theScore:k,theHp:S,theName:e})})),De.action("bullet",(e=>{let t=e.wDirection;"down"==t&&e.move(0,500),"up"==t&&e.move(0,-500),"left"==t&&e.move(-500,0),"right"==t&&e.move(500,0),l(.5,(()=>{r(e)}))})),De.action("enemy",(e=>{Ee(b.pos.x,b.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy2",(e=>{Ee(b.pos.x,b.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy3",(e=>{Ee(b.pos.x,b.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("reset",(e=>{(e.pos.x>790||e.pos.x<0||e.pos.y>790||e.pos.y<0)&&(r(e),console.log("destryoed"))})),De.collides("door","hades",(()=>{x.pause(),_.stop(),i("level2",{theScore:k,theHp:S,theName:e})})),De.collides("reset","hades",((e,t)=>{n(12),a("hit",{volume:1,speed:1}),t.hurt(1),S--,A.use(h(`${S}`))})),De.collides("enemy","bullet",((e,t)=>{e.hurt(1),r(t),T()})),De.collides("enemy2","bullet",((e,t)=>{e.hurt(1),r(t),T()})),De.collides("enemy3","bullet",((e,t)=>{e.hurt(1),r(t),T()})),b.action((()=>{b.resolve()})),t([c("longWall"),m(),s(0,-15)]),t([c("longWall"),m(),s(0,798)]),t([c("vWall"),m(),s(799,0)]),t([c("vWall"),m(),s(-14,0)]);var _=De.loop(5,(()=>{P<1?(De.loop(2,(()=>{0==v("reset").length&&t([c("door"),s(400,400),u(2),"door"])})),_.stop()):(function(){let e=[c("enemy"),s(p(d(0),d(790))),u(3),"enemy","reset",E(2),m()];t(e)}(),function(){let e=[c("enemy2"),s(p(d(0),d(790))),u(2),"enemy2","reset",E(1),m()];t(e)}(),function(){let e=[c("enemy3"),s(p(d(10),d(790))),u(2),"enemy3","reset",E(1),m()];t(e)}(),P--,P<=0?(P=0,D.use(h(`Wave :${P}`,8))):D.use(h(`Wave :${P}`,8)))}))})),De.scene("level2",(e=>{console.log(e);const{add:t,pos:s,color:o,destroy:r,camShake:n,go:i,play:a,wait:l,scale:u,sprite:c,text:h,vec2:d,rand:p,solid:m,layers:f,layer:y,rgba:g,get:v}=De;let w="up";const x=a("levelTwoMusic",{volume:.6,detune:-100});x.loop(),x.play();const b=t([c("hades"),s(200,200),u(1),E(e.theHp),m(),"hades"]);f(["bg","ui","game"],"game");var k=e.theScore,S=b.hp();let P=14;const R=t([h(`${k}`),s(50,60),o(g(1,1,1)),u(2),y("ui"),"score"]),A=(t([c("star"),s(10,50),u(.5),y("ui"),"star"]),t([h(`${S}`),s(50,100),o(g(1,0,0)),u(2),y("ui"),"score"])),D=(t([c("heartIcon"),s(10,90),u(.5),y("ui"),"heart"]),t([h(`Wave :${P}`,8),s(325,50),o(g(1,0,.3)),u(2),y("ui"),"wave"]));function E(t){return{hurt(s){if(t-=s,"hades"==this._tags[0]){var o=document.getElementById("game-container");o.style.backgroundColor="red",De.wait(.2,(()=>{o.style.backgroundColor="black"}))}t<=0&&("hades"==this._tags[0]&&(x.stop(),r(this),e.theHp=t,e.theScore=k,e.outcome=!1,i("endScreen",e)),r(this))},heal(e){t+=e},hp:()=>t}}function T(){k++,R.use(h(`${k}`))}De.keyPress("s",(()=>{w="down"})),De.keyPress("w",(()=>{w="up"})),De.keyPress("c",(()=>{crashFunction()})),De.keyPress("a",(()=>{w="left"})),De.keyPress("d",(()=>{w="right"})),De.keyDown("s",(()=>{b.move(0,300)})),De.keyDown("w",(()=>{b.move(0,-300)})),De.keyDown("a",(()=>{b.move(-300,0)})),De.keyDown("d",(()=>{b.move(300,0)})),De.keyPress("space",(()=>{var e;a("shoot",{volume:.6,speed:1}),t("left"==(e=w)?[c("bulletLeft"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}]:"right"==e?[c("bulletRight"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}]:"up"==e?[c("bulletUp"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}]:[c("bulletDown"),s(b.pos.x,b.pos.y),"bullet",{wDirection:e}])})),De.keyPress("enter",(()=>{i("levelTwoPointFive",{theScore:k,theHp:S,theName:e.theName,theMusic:x})})),De.action("bullet",(e=>{let t=e.wDirection;"down"==t&&e.move(0,500),"up"==t&&e.move(0,-500),"left"==t&&e.move(-500,0),"right"==t&&e.move(500,0),l(.5,(()=>{r(e)}))})),De.action("reset",(e=>{(e.pos.x>790||e.pos.x<0||e.pos.y>790||e.pos.y<0)&&r(e)})),De.action("enemy",(e=>{Ee(b.pos.x,b.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy2",(e=>{Ee(b.pos.x,b.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy3",(e=>{Ee(b.pos.x,b.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.collides("reset","hades",((e,t)=>{n(12),a("hit",{volume:1,speed:1}),t.hurt(1),S--,A.use(h(`${S}`))})),De.action("reset",(e=>{(e.pos.x>790||e.pos.x<0||e.pos.y>790||e.pos.y<0)&&r(e)})),De.collides("enemy","bullet",((e,t)=>{e.hurt(1),r(t),T()})),De.collides("enemy2","bullet",((e,t)=>{e.hurt(1),r(t),T()})),De.collides("enemy3","bullet",((e,t)=>{e.hurt(1),r(t),T()})),b.action((()=>{b.resolve()})),t([c("longWall"),m(),s(0,-15)]),t([c("longWall"),m(),s(0,798)]),t([c("vWall"),m(),s(799,0)]),t([c("vWall"),m(),s(-14,0)]),De.loop(4,(()=>{7==P?De.loop(2,(()=>{0==v("reset").length&&i("levelTwoPointFive",{theScore:k,theHp:S,theName:e.theName,theMusic:x})})):(function(){let e=[c("enemy"),s(p(d(0),d(790))),u(3),"enemy","reset",E(4),m()];t(e)}(),function(){let e=[c("enemy2"),s(p(d(0),d(790))),u(2),"enemy2","reset",E(2),m()];t(e)}(),function(){let e=[c("enemy3"),s(p(d(10),d(790))),u(2),"enemy3","reset",E(2),m()];t(e)}(),P--,P<=0?(P=0,D.use(h(`Wave :${P}`,8))):D.use(h(`Wave :${P}`,8)))}))})),De.scene("levelTwoPointFive",(e=>{console.log(e);const{add:t,pos:s,color:o,destroy:r,camShake:n,go:i,play:a,wait:l,scale:u,sprite:c,text:h,vec2:d,rand:p,solid:m,layers:f,layer:y,rgba:g,get:v}=De;let w="up";const x=t([c("hades"),s(200,200),u(1),E(e.theHp),m(),"hades"]);f(["bg","ui","game"],"game");var b=e.theScore,k=x.hp();let S=7;const P=e.theMusic,R=t([h(`${b}`),s(50,60),o(g(1,1,1)),u(2),y("ui"),"score"]),A=(t([c("star"),s(10,50),u(.5),y("ui"),"star"]),t([h(`${k}`),s(50,100),o(g(1,0,0)),u(2),y("ui"),"score"])),D=(t([c("heartIcon"),s(10,90),u(.5),y("ui"),"heart"]),t([h(`Wave :${S}`,8),s(325,50),o(g(1,0,.3)),u(2),y("ui"),"wave"]));function E(t){return{hurt(s){if(t-=s,"hades"==this._tags[0]){var o=document.getElementById("game-container");o.style.backgroundColor="red",De.wait(.2,(()=>{o.style.backgroundColor="black"}))}t<=0&&("hades"==this._tags[0]&&(P.stop(),r(this),e.theHp=t,e.theScore=b,e.outcome=!1,i("endScreen",e)),r(this))},heal(e){t+=e},hp:()=>t}}function T(){b++,R.use(h(`${b}`))}De.keyPress("s",(()=>{w="down"})),De.keyPress("w",(()=>{w="up"})),De.keyPress("c",(()=>{crashFunction()})),De.keyPress("a",(()=>{w="left"})),De.keyPress("d",(()=>{w="right"})),De.keyDown("s",(()=>{x.move(0,300)})),De.keyDown("w",(()=>{x.move(0,-300)})),De.keyDown("a",(()=>{x.move(-300,0)})),De.keyDown("d",(()=>{x.move(300,0)})),De.keyPress("space",(()=>{var e;a("shoot",{volume:.6,speed:1}),t("left"==(e=w)?[c("bulletLeft"),s(x.pos.x,x.pos.y),"bullet",{wDirection:e}]:"right"==e?[c("bulletRight"),s(x.pos.x,x.pos.y),"bullet",{wDirection:e}]:"up"==e?[c("bulletUp"),s(x.pos.x,x.pos.y),"bullet",{wDirection:e}]:[c("bulletDown"),s(x.pos.x,x.pos.y),"bullet",{wDirection:e}])})),De.keyPress("enter",(()=>{P.stop(),i("bossFight",{theScore:b,theHp:k,theName:e.theName})})),De.action("bullet",(e=>{let t=e.wDirection;"down"==t&&e.move(0,500),"up"==t&&e.move(0,-500),"left"==t&&e.move(-500,0),"right"==t&&e.move(500,0),l(.5,(()=>{r(e)}))})),De.action("reset",(e=>{(e.pos.x>790||e.pos.x<0||e.pos.y>790||e.pos.y<0)&&(r(e),console.log("destryoed"))})),De.action("enemy",(e=>{Ee(x.pos.x,x.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy2",(e=>{Ee(x.pos.x,x.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy3",(e=>{Ee(x.pos.x,x.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.collides("reset","hades",((e,t)=>{n(12),a("hit",{volume:1,speed:1}),t.hurt(1),k--,A.use(h(`${k}`))})),De.collides("door","hades",(()=>{P.stop(),i("bossFight",{theScore:b,theHp:k,theName:e.theName})})),De.action("reset",(e=>{(e.pos.x>790||e.pos.x<0||e.pos.y>790||e.pos.y<0)&&(r(e),console.log("destryoed"))})),De.collides("enemy","bullet",((e,t)=>{e.hurt(1),r(t),T()})),De.collides("enemy2","bullet",((e,t)=>{e.hurt(1),r(t),T()})),De.collides("enemy3","bullet",((e,t)=>{e.hurt(1),r(t),T()})),x.action((()=>{x.resolve()})),t([c("longWall"),m(),s(0,-15)]),t([c("longWall"),m(),s(0,798)]),t([c("vWall"),m(),s(799,0)]),t([c("vWall"),m(),s(-14,0)]);var _=De.loop(4,(()=>{0==S?(De.loop(2,(()=>{0==v("reset").length&&t([c("door"),s(400,400),u(2),"door"])})),_.stop()):(function(){let e=[c("enemy"),s(p(d(0),d(790))),u(3),"enemy","reset",E(4),m()];t(e)}(),function(){let e=[c("enemy2"),s(p(d(0),d(790))),u(2),"enemy2","reset",E(2),m()];t(e)}(),function(){let e=[c("enemy3"),s(p(d(10),d(790))),u(2),"enemy3","reset",E(2),m()];t(e)}(),S--,S<=0?(S=0,D.use(h(`Wave :${S}`,8))):D.use(h(`Wave :${S}`,8)))}))})),De.scene("bossFight",(e=>{console.log(e);const{add:t,pos:s,color:o,destroy:r,camShake:n,go:i,play:a,wait:l,scale:u,sprite:c,text:h,solid:d,layers:p,layer:m,rgba:f,camRot:y,camIgnore:g,camScale:v,camPos:w}=De;let x="up",b=0;var k=0,S=0,P=!1;const R=a("firstPhase",{volume:.4});R.loop(),R.play();const A=t([c("hades"),s(100,100),u(1),B(e.theHp),d(),"hades"]);p(["bg","ui","game"],"game");var D=e.theScore,E=A.hp();const T=t([h(`${D}`),s(50,60),o(f(1,1,1)),u(2),m("ui"),"score"]),_=(t([c("star"),s(10,50),u(.5),m("ui"),"star"]),t([h(`${E}`),s(50,100),o(f(1,0,0)),u(2),m("ui"),"score"]));t([c("heartIcon"),s(10,90),u(.5),m("ui"),"heart"]);let F=t([c("enemy"),s(200,200),u(5),"boss","reset",B(25),d()]);function B(t){return{hurt(s){if(t-=s,"hades"==this._tags[0]){var o=document.getElementById("game-container");o.style.backgroundColor="red",De.wait(.2,(()=>{o.style.backgroundColor="black"}))}if(t<=0)if("hades"==this._tags[0]&&(re.stop(),R.stop(),r(this),e.theHp=t,e.theScore=D,e.outcome=!1,i("endScreen",e)),"boss"==this._tags[0]){re.stop(),R.stop();var a=De.loop(.1,(()=>{n(20)}));l(3,(()=>{w(F.pos.x+45,F.pos.y+40),v(2.5),l(2,(()=>{e.camPosX=F.pos.x+45,e.camPosY=F.pos.y+40,e.bossX=F.pos.x,e.bossY=F.pos.y,e.hadesPosX=A.pos.x,e.hadesPosY=A.pos.y,a.stop(),i("bossFightTransition",e)}))}))}else r(this)},heal(e){t+=e},hp:()=>t}}function I(){E--,_.use(h(`${E}`))}var M=258,L=646,C=761,q=699,N=761,Y=215,H=-761,O=-699,U=0,W=-500,j=-600,z=0,X=20,$=-450,J=450,G=0,V=400,K=-400,Q=-400,Z=20,ee=-400,te=400,se=20,oe=400;De.action("bossBullet",(e=>{1==b&&e.move(M,L),2==b&&e.move(ee,te),3==b&&e.move(J,G),4==b&&e.move(j,z),l(1,(()=>{r(e)}))})),De.action("bossBullet1",(e=>{1==b&&e.move(C,q),2==b&&e.move(se,oe),3==b&&e.move(X,$),4==b&&e.move(H,O),l(1,(()=>{r(e)}))})),De.action("bossBullet2",(e=>{1==b&&e.move(N,Y),2==b&&e.move(Q,Z),3==b&&e.move(V,K),4==b&&e.move(U,W),l(1,(()=>{r(e)}))})),De.keyPress("s",(()=>{x="down"})),De.keyPress("w",(()=>{x="up"})),De.keyPress("c",(()=>{crashFunction()})),De.keyPress("a",(()=>{x="left"})),De.keyPress("d",(()=>{x="right"})),De.keyDown("s",(()=>{A.move(0,300)})),De.keyDown("w",(()=>{A.move(0,-300)})),De.keyDown("a",(()=>{A.move(-300,0)})),De.keyDown("d",(()=>{A.move(300,0)})),De.keyPress("space",(()=>{var e;a("shoot",{volume:.6,speed:1}),t("left"==(e=x)?[c("bulletLeft"),s(A.pos.x,A.pos.y),"bullet",{wDirection:e}]:"right"==e?[c("bulletRight"),s(A.pos.x,A.pos.y),"bullet",{wDirection:e}]:"up"==e?[c("bulletUp"),s(A.pos.x,A.pos.y),"bullet",{wDirection:e}]:[c("bulletDown"),s(A.pos.x,A.pos.y),"bullet",{wDirection:e}])})),F.action((()=>{P&&F.move(k,S)})),De.action("bullet",(e=>{let t=e.wDirection;"down"==t&&e.move(0,500),"up"==t&&e.move(0,-500),"left"==t&&e.move(-500,0),"right"==t&&e.move(500,0),l(.5,(()=>{r(e)}))})),De.collides("reset","hades",((e,t)=>{n(12),a("hit",{volume:1,speed:1}),t.hurt(1),I()})),De.collides("boss","bullet",((e,t)=>{e.hurt(1),F.changeSprite("enemy2"),l(.3,(()=>{F.changeSprite("enemy")})),r(t),D++,T.use(h(`${D}`))})),De.collides("hades","bossBullet",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),I()})),De.collides("hades","bossBullet1",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),I()})),De.collides("hades","bossBullet2",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),I()}));var re=De.loop(3,(()=>{_e(F.pos.x,F.pos.y).then((e=>{k=e.x,S=e.y})),P||(P=!0),l(2,(()=>{var e,o;(e=F.pos.x,o=F.pos.y,new Promise((function(t,s){return e<400&&o<400?t(1):e<400&&o>400?t(3):e>400&&o<400?t(2):e>400&&o>400?t(4):void 0}))).then((e=>{b=e})),P=!1,t([c("bullet"),s(F.pos.x,F.pos.y),"bossBullet"]),t([c("bullet"),s(F.pos.x,F.pos.y),"bossBullet1"]),t([c("bullet"),s(F.pos.x,F.pos.y),"bossBullet2"])}))}));A.action((()=>{A.resolve()})),t([c("longWall"),d(),s(0,-15)]),t([c("longWall"),d(),s(0,798)]),t([c("vWall"),d(),s(799,0)]),t([c("vWall"),d(),s(-14,0)])})),De.scene("bossFightFinalPhase",(e=>{console.log(e);const{add:t,pos:s,color:o,destroy:r,camShake:n,go:i,play:a,wait:l,scale:u,sprite:c,text:h,solid:d,layers:p,layer:m,rgba:f,rand:y,vec2:g,camPos:v,camScale:w}=De;let x="up";var b=0,k=0;const S=a("secondphase",{volume:.4});S.play();const P=t([c("hades"),s(e.hadesPosX,e.hadesPosY),u(1),_(e.theHp),d(),"hades"]);p(["bg","ui","game"],"game");var R=e.theScore,A=P.hp();const D=t([h(`${R}`),s(50,60),o(f(1,1,1)),u(2),m("ui"),"score"]),E=(t([c("star"),s(10,50),u(.5),m("ui"),"star"]),t([h(`${A}`),s(50,100),o(f(1,0,0)),u(2),m("ui"),"score"]));t([c("heartIcon"),s(10,90),u(.5),m("ui"),"heart"]);let T=t([c("enemy3"),s(e.bossX,e.bossY),u(5),"boss","reset",_(50),d()]);function _(t){return{hurt(s){if(t-=s,"hades"==this._tags[0]){var o=document.getElementById("game-container");o.style.backgroundColor="red",De.wait(.2,(()=>{o.style.backgroundColor="black"}))}t<=0&&("hades"==this._tags[0]&&(S.stop(),r(this),e.theHp=t,e.theScore=R,e.outcome=!1,i("endScreen",e)),"boss"==this._tags[0]?(r(this),S.stop(),i("startScreen")):r(this))},heal(e){t+=e},hp:()=>t}}function F(){R++,D.use(h(`${R}`))}function B(){A--,E.use(h(`${A}`))}function I(){t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet1"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet2"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet3"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet4"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet5"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet6"]),t([c("bullet"),s(T.pos.x,T.pos.y),"bossBullet7"])}De.action("bot",(e=>{Ee(P.pos.x,P.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("bot1",(e=>{Ee(P.pos.x,P.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("bot2",(e=>{Ee(P.pos.x,P.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()}));var M=258,L=646,C=761,q=699,N=761,Y=215,H=-761,O=-699,U=0,W=-500,j=400,z=-400,X=-400,$=20,J=-400,G=400;De.action("bossBullet",(e=>{e.move(M,L),l(1,(()=>{r(e)}))})),De.action("bossBullet1",(e=>{e.move(C,q),l(1,(()=>{r(e)}))})),De.action("bossBullet2",(e=>{e.move(N,Y),l(1,(()=>{r(e)}))})),De.action("bossBullet3",(e=>{e.move(X,$),l(1,(()=>{r(e)}))})),De.action("bossBullet4",(e=>{e.move(J,G),l(1,(()=>{r(e)}))})),De.action("bossBullet5",(e=>{e.move(U,W),l(1,(()=>{r(e)}))})),De.action("bossBullet6",(e=>{e.move(H,O),l(1,(()=>{r(e)}))})),De.action("bossBullet7",(e=>{e.move(j,z),l(1,(()=>{r(e)}))})),De.keyPress("s",(()=>{x="down"})),De.keyPress("w",(()=>{x="up"})),De.keyPress("c",(()=>{crashFunction()})),De.keyPress("a",(()=>{x="left"})),De.keyPress("d",(()=>{x="right"})),De.keyDown("s",(()=>{P.move(0,300)})),De.keyDown("w",(()=>{P.move(0,-300)})),De.keyDown("a",(()=>{P.move(-300,0)})),De.keyDown("d",(()=>{P.move(300,0)})),De.keyPress("space",(()=>{var e;a("shoot",{volume:.6,speed:1}),t("left"==(e=x)?[c("bulletLeft"),s(P.pos.x,P.pos.y),"bullet",{wDirection:e}]:"right"==e?[c("bulletRight"),s(P.pos.x,P.pos.y),"bullet",{wDirection:e}]:"up"==e?[c("bulletUp"),s(P.pos.x,P.pos.y),"bullet",{wDirection:e}]:[c("bulletDown"),s(P.pos.x,P.pos.y),"bullet",{wDirection:e}])})),T.action((()=>{T.move(b,k),T.resolve()})),De.action("bullet",(e=>{let t=e.wDirection;"down"==t&&e.move(0,500),"up"==t&&e.move(0,-500),"left"==t&&e.move(-500,0),"right"==t&&e.move(500,0),l(.5,(()=>{r(e)}))})),De.action("enemy2",(e=>{Ee(P.pos.x,P.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.action("enemy3",(e=>{Ee(P.pos.x,P.pos.y,e.pos.x,e.pos.y).then((t=>{e.move(t.x,t.y)})),e.resolve()})),De.collides("reset","hades",((e,t)=>{n(12),a("hit",{volume:1,speed:1}),t.hurt(1),B()})),De.collides("boss","bullet",((e,t)=>{e.hurt(1),T.changeSprite("enemy2"),l(.3,(()=>{T.changeSprite("enemy3")})),r(t),F()})),De.collides("bullet","bot",((e,t)=>{t.hurt(1),r(e),F()})),De.collides("bullet","bot1",((e,t)=>{t.hurt(1),r(e),F()})),De.collides("bullet","bot2",((e,t)=>{t.hurt(1),r(e),F()})),De.collides("hades","bossBullet",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet1",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet2",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet3",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet4",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet5",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet6",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.collides("hades","bossBullet7",((e,t)=>{n(12),a("hurt",{volume:.3,speed:1}),e.hurt(1),r(t),B()})),De.loop(15,(()=>{t([c("enemy"),s(y(g(0),g(790))),u(3),"bot","reset",_(4),d()]),t([c("enemy"),s(y(g(0),g(790))),u(3),"bot1","reset",_(4),d()]),t([c("enemy"),s(y(g(0),g(790))),u(3),"bot2","reset",_(4),d()])})),De.loop(2,(()=>{I()})),De.loop(2.5,(()=>{_e(T.pos.x,T.pos.y).then((e=>{b=e.x,k=e.y})),l(1,(()=>{I()})),l(2,(()=>{I()}))})),P.action((()=>{P.resolve()})),t([c("longWall"),d(),s(0,-15)]),t([c("longWall"),d(),s(0,798)]),t([c("vWall"),d(),s(799,0)]),t([c("vWall"),d(),s(-14,0)])})),De.scene("bossFightTransition",(e=>{console.log(e);const{add:t,pos:s,color:o,camShake:r,go:n,play:i,wait:a,scale:l,sprite:u,layers:c,layer:h,camScale:d,camPos:p}=De;c(["bg","ui","game"],"game"),t([u("hades"),s(e.hadesPosX,e.hadesPosY),l(1)]);let m=t([u("enemy"),s(e.bossX,e.bossY),l(5),"boss","reset"]);p(e.camPosX,e.camPosY);var f=2.5;d(f),a(1,(()=>{let t=De.loop(1,(()=>{m.changeSprite("enemy2"),a(.5,(()=>{m.changeSprite("enemy")}))}));a(3,(()=>{t.stop(),m.changeSprite("enemy3");var s=De.loop(.2,(()=>{d(f-=.1),f<=1&&(s.stop(),p(400,400),a(2,(()=>{n("bossFightFinalPhase",e)})))}))}))}))})),De.scene("endScreen",(e=>{console.log(e),document.getElementById("game-container").style.backgroundColor="black";const{add:t,pos:s,color:o,go:r,play:n,scale:i,text:a,rgba:l}=De;var u;t([a("Score"),s(335,360),o(l(1,1,1)),i(2)]),t([a(`${e.theScore}`),s(364,390),o(l(1,1,1)),i(2)]),e.outcome?((u=n("win")).play(),t([a("You Won!",9),s(320,300),o(l(1,1,1)),i(2)])):((u=n("died")).play(),t([a("You Died",9),s(314,300),o(l(1,.1,0)),i(2)])),t([a("Press R To Restart"),s(256,460),o(l(1,1,1)),i(2)]),t([a("Press Enter To Save Score"),s(195,500),o(l(1,1,1)),i(2)]),De.keyPress("r",(()=>{u.pause(),r("startScreen")})),De.keyPress("enter",(()=>{u.pause();let t={username:e.theName,score:e.theScore};fetch("https://desolate-citadel-26138.herokuapp.com/updateScore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((()=>{alert("score added"),r("startScreen")})).catch((()=>{alert("failed to add score")}))}))})),De.start("startScreen")})();